
# Step 1. Create cmData objects locally; then export to shared drive
# Step 2. Create features locally
# Step 3. Create df / perform PSM; perform either location


# devtools::install_github("OHDSI/DatabaseConnector", ref="v2.4.3", args="--no-multiarch")

# ==================================================================================================================
# Create connection
# ==================================================================================================================

# devtools::install_github("tidyverse/ggplot2",ref = "v3.2.0")
# devtools::install_github("OHDSI/CohortMethod", ref="develop")
# devtools::install_github("OHDSI/CohortMethod", ref="v3.1.1", args="--no-multiarch")
# devtools::install_github("OHDSI/FeatureExtraction", ref="v2.2.5", args="--no-multiarch")
# devtools::install_github("OHDSI/DatabaseConnector", ref="v3.0.0", args="--no-multiarch")
# devtools::install_github("OHDSI/Cyclops", ref="v2.0.3", args="--no-multiarch")
# devtools::install_github("OHDSI/SqlRender", ref="v1.6.4", args="--no-multiarch")

# Set timezone
Sys.setenv(TZ='GMT')

# Sets Java Home
if (Sys.getenv("JAVA_HOME")!="")
  Sys.setenv(JAVA_HOME="")

# Package availability check and installation
if (!require("pacman")) install.packages("pacman")
if (!require('gurobi')){install.packages("C:/gurobi903/win64/R/gurobi_9.0-3.zip", repos = NULL)}
pacman::p_load(devtools, drat, CohortMethod, SqlRender, DatabaseConnector, grid, reshape2, dplyr,
               designmatch, caret, rdist, gurobi, EmpiricalCalibration, caTools, openxlsx, MatchIt,
               CohortDiagnostics)

# Set connection details
drat::addRepo("OHDSI")
connectionDetails <- createConnectionDetails(
  dbms = ,
  server = ,
  extraSettings = ,
  port = ,
  user = ,
  password = 
)
connection <- connect(connectionDetails)

options(scipen=999)


# ==================================================================================================================
# Define parameters
# ==================================================================================================================

# Set working directory
wd <- ""
setwd(wd)

# Set parameter settings
cohortDatabaseSchema <- ""  
cdmDatabaseSchema <- "" 
cdmVersion <- "5"
oracleTempSchema <- NULL
ohdsiSchema <- ""
cohortOutcomeTable <- ""
cohortTable <- ""
cohortAttributeTable <- ""
attributeDefinitionTable <- ""
cmDataFolder <- paste0(wd, "/cmData")
splitRatio <- 
num_cohorts <- 

# Define cohort ids
cohort_id_1 <-      # Comparator 1
cohort_id_2 <-       # Comparator 2
cohort_id_3 <-       # Outcome

# Define negative control concept ids
ncs <- c(434165,436409,199192,4088290,4092879,44783954,75911,137951,77965,
         376707,4103640,73241,133655,73560,434327,4213540,140842,81378,
         432303,4201390,46269889,134438,78619,201606,76786,4115402,
         45757370,433111,433527,4170770,4092896,259995,40481632,4166231,
         433577,4231770,440329,4012570,4012934,441788,4201717,374375,
         4344500,139099,444132,196168,432593,434203,438329,195873,4083487,
         4103703,4209423,377572,40480893,136368,140648,438130,4091513,
         373478,46286594,439790,81634,380706,141932,36713918,
         443172,81151,72748,378427,437264,194083,140641,440193,4115367,
         36713926,79864,36717682,438120,440704,441277,436373,4002818,
         73754,136773,376382,439776,4248728,440021,434626,4241530,
         3671469,36717115,437969,4119307,195590,42873170,80502,
         436785,74464,72404,439935,437092,442306,378424)


# ==================================================================================================================
# Create outcome table
# ==================================================================================================================

if(!dir.exists(cmDataFolder)){
  print("Creating outcome table")
  
  # Create outcome cohort table
  createCohortTable(connectionDetails = connectionDetails,
                    cohortDatabaseSchema = cohortDatabaseSchema,
                    cohortTable = cohortOutcomeTable)
  
  # Populate cohort table
  sql <- readSql("create_outcome_table.sql")
  sql <- render(sql,
                cdmDatabaseSchema = strsplit(cdmDatabaseSchema, "[.]")[[1]][1],
                cohortDatabaseSchema = cohortDatabaseSchema,
                cohortOutcomeTable = cohortOutcomeTable,
                cohort_id_3 = cohort_id_3,
                ohdsiSchema = ohdsiSchema)
  sql <- translate(sql, targetDialect = connectionDetails$dbms)
  executeSql(connection, sql)
  
  # Populate negative controls
  sql <- readSql("create_negative_controls.sql")
  sql <- render(sql,
                cdmDatabaseSchema = strsplit(cdmDatabaseSchema, "[.]")[[1]][1],
                cohortDatabaseSchema = cohortDatabaseSchema,
                cohortOutcomeTable = cohortOutcomeTable,
                ncs = ncs)
  sql <- translate(sql, targetDialect = connectionDetails$dbms)
  executeSql(connection, sql)
  
  rm(sql)
} else{
  print("Outcome table already created - skipping")
}
rm(cohort_id_3)


# ==================================================================================================================
# Create cohort table
# ==================================================================================================================

if(!dir.exists(cmDataFolder)){
  print("Creating cohort table")
  
  # Create outcome cohort table
  createCohortTable(connectionDetails = connectionDetails,
                    cohortDatabaseSchema = cohortDatabaseSchema,
                    cohortTable = cohortTable)
  
  # Populate cohort table
  sql <- readSql("create_cohort_table.sql")
  sql <- render(sql,
                cdmDatabaseSchema = strsplit(cdmDatabaseSchema, "[.]")[[1]][1],
                cohortDatabaseSchema = cohortDatabaseSchema,
                cohortTable = cohortTable,
                cohort_id_1 = cohort_id_1,
                cohort_id_2 = cohort_id_2,
                ohdsiSchema = ohdsiSchema)
  sql <- translate(sql, targetDialect = connectionDetails$dbms)
  executeSql(connection, sql)
  
  rm(sql)
} else{
  print("Cohort table already created - skipping")
}


# ==================================================================================================================
# Explore outcome / cohort tables
# ==================================================================================================================

# # Test outcome table
# sql <- paste("SELECT cohort_definition_id, COUNT(*) AS count",
#              "FROM @cohortDatabaseSchema.@cohortOutcomeTable",
#              "GROUP BY cohort_definition_id")
# sql <- render(sql,
#               cohortDatabaseSchema = cohortDatabaseSchema,
#               cohortOutcomeTable = cohortOutcomeTable)
# sql <- translate(sql, targetDialect = connectionDetails$dbms)
# querySql(connection, sql)
# 
# # Test cohort table
# sql <- paste("SELECT cohort_definition_id, COUNT(*) AS count",
#              "FROM @cohortDatabaseSchema.@cohortTable",
#              "GROUP BY cohort_definition_id")
# sql <- render(sql,
#               cohortDatabaseSchema = cohortDatabaseSchema,
#               cohortTable = cohortTable)
# sql <- translate(sql, targetDialect = connectionDetails$dbms)
# querySql(connection, sql)


# ==================================================================================================================
# Create cmData object
# ==================================================================================================================

if(!dir.exists(cmDataFolder)){
  print("Creating cmData object")
  
  # Target and comparator ingredient concepts
  aceI <- c(1335471,1340128,1341927,1363749,1308216,1310756,1373225, 1331235,1334456,1342439)
  bblock <- c(1353766, 1345858, 1327978, 1314577, 1313200, 1307046, 1386957, 1346823, 1338005, 1322081, 1314002, 1319998)
  
  # Define which types of covariates must be constructed
  cs <- createDefaultCovariateSettings(excludedCovariateConceptIds = c(aceI, bblock),
                                       addDescendantsToExclude = TRUE)
  rm(aceI, bblock)
  
  # Create cmData
  cmData <- getDbCohortMethodData(connectionDetails = connectionDetails,
                                  cdmDatabaseSchema = cdmDatabaseSchema,
                                  oracleTempSchema = oracleTempSchema,
                                  targetId = 1,
                                  comparatorId = 2,
                                  outcomeIds = 3,
                                  studyStartDate = "",
                                  studyEndDate = "",
                                  exposureDatabaseSchema = cohortDatabaseSchema,
                                  exposureTable = cohortTable,
                                  outcomeDatabaseSchema = cohortDatabaseSchema,
                                  outcomeTable = cohortOutcomeTable,
                                  cdmVersion = cdmVersion,
                                  firstExposureOnly = FALSE,
                                  removeDuplicateSubjects = "remove all",
                                  restrictToCommonPeriod = FALSE,
                                  washoutPeriod = 365,
                                  covariateSettings = cs)
  rm(cs)
  
  # summary(cmData)
  
  # Save cmData
  saveCohortMethodData(cmData, cmDataFolder)
  rm(cmData)
} else{
  print("cmData object already created - skipping")
}


# ==================================================================================================================
# Create split cohort tables
# ==================================================================================================================

# Define study population
cmData <- loadCohortMethodData(cmDataFolder)
studyPop <- createStudyPopulation(cohortMethodData = cmData,
                                  outcomeId = 3,
                                  firstExposureOnly = FALSE,
                                  restrictToCommonPeriod = FALSE,
                                  washoutPeriod = 365,
                                  removeDuplicateSubjects = "remove all",
                                  removeSubjectsWithPriorOutcome = FALSE,
                                  minDaysAtRisk = 1,
                                  riskWindowStart =1,
                                  startAnchor = "cohort start",
                                  riskWindowEnd = 0,
                                  endAnchor = "cohort end")
studyPop_t <- studyPop[studyPop$treatment == 1, ]
studyPop_c <- studyPop[studyPop$treatment == 0, ]
rm(cmData, studyPop)

# Target and comparator ingredient concepts
aceI <- c(1335471,1340128,1341927,1363749,1308216,1310756,1373225, 1331235,1334456,1342439)
bblock <- c(1353766, 1345858, 1327978, 1314577, 1313200, 1307046, 1386957, 1346823, 1338005, 1322081, 1314002, 1319998)

# Define which types of covariates must be constructed
cs <- createDefaultCovariateSettings(excludedCovariateConceptIds = c(aceI, bblock),
                                     addDescendantsToExclude = TRUE)
rm(aceI, bblock)

set.seed(1)
idx_c <- sample(rep(1:(1/splitRatio), each = ceiling(nrow(studyPop_c)/(1/splitRatio)))[1:nrow(studyPop_c)])
idx_t <- sample(rep(1:(1/splitRatio), each = ceiling(nrow(studyPop_t)/(1/splitRatio)))[1:nrow(studyPop_t)])

# Create cohorts on SQL server, and local cmData objects
for(i in 1:num_cohorts){
  
  # Check whether already created
  if(file.exists(paste(wd, "/cohort_", i, "/cmData/outcomes.rds", sep = ""))){
    print(paste("Cohort", i, "exists - moving to next cohort"))
    next
  } else{
    print(paste("Creating cohort", i))
  }
  
  # Create split
  t <- studyPop_t[idx_t == i, ]
  c <- studyPop_c[idx_c == i, ]
  subjectIds <- c(t$subjectId, c$subjectId)
  
  disconnect(connection)
  connection <- connect(connectionDetails)
  
  # Create cohort table
  CohortDiagnostics::createCohortTable(connectionDetails = connectionDetails,
                                       cohortDatabaseSchema = cohortDatabaseSchema,
                                       cohortTable = paste0(cohortTable, "_", i))
  
  disconnect(connection)
  connection <- connect(connectionDetails)
  
  # Populate cohort table
  sql <- readSql("create_split_cohort_table.sql")
  sql <- render(sql,
                cdmDatabaseSchema = strsplit(cdmDatabaseSchema, "[.]")[[1]][1],
                cohortDatabaseSchema = cohortDatabaseSchema,
                ohdsiSchema = ohdsiSchema,
                cohortTable = paste0(cohortTable, "_", i),
                cohort_id_1 = cohort_id_1,
                cohort_id_2 = cohort_id_2,
                subjectIds = subjectIds)
  sql <- translate(sql, targetDialect = connectionDetails$dbms)
  executeSql(connection, sql)
  
  # # Test cohort table appropriately created
  # sql <- paste("SELECT cohort_definition_id, COUNT(*) AS count",
  #              "FROM @cohortDatabaseSchema.@cohortTable",
  #              "GROUP BY cohort_definition_id")
  # sql <- render(sql,
  #               cohortDatabaseSchema = cohortDatabaseSchema,
  #               cohortTable = paste0(cohortTable, "_", i))
  # sql <- translate(sql, targetDialect = connectionDetails$dbms)
  # print(querySql(connection, sql))
  
  disconnect(connection)
  connection <- connect(connectionDetails)
  
  # Create cmData
  cmData <- getDbCohortMethodData(connectionDetails = connectionDetails,
                                  cdmDatabaseSchema = cdmDatabaseSchema,
                                  oracleTempSchema = oracleTempSchema,
                                  targetId = 1,
                                  comparatorId = 2,
                                  outcomeIds = 3,
                                  studyStartDate = "",
                                  studyEndDate = "",
                                  exposureDatabaseSchema = cohortDatabaseSchema,
                                  exposureTable = paste0(cohortTable, "_", i),
                                  outcomeDatabaseSchema = cohortDatabaseSchema,
                                  outcomeTable = cohortOutcomeTable,
                                  cdmVersion = cdmVersion,
                                  firstExposureOnly = FALSE,
                                  removeDuplicateSubjects = FALSE,
                                  restrictToCommonPeriod = FALSE,
                                  washoutPeriod = 365,
                                  covariateSettings = cs)
  
  # Save cmData
  if(!dir.exists(paste0(wd, "/cohort_", i))){
    dir.create(paste0(wd, "/cohort_", i))
  }
  saveCohortMethodData(cmData, paste0(wd, "/cohort_", i, "/cmData"))
  
  rm(t, c, subjectIds, sql, cmData)
}
rm(studyPop_t, cohort_id_1, cohort_id_2, studyPop_c, cs, splitRatio, idx_c, idx_t)


# ==================================================================================================================
# Explore cohort tables
# ==================================================================================================================

# # Test cohorts appropriately generated
# for(i in 1:num_cohorts){
#   sql <- paste("SELECT cohort_definition_id, COUNT(*) AS count",
#                "FROM @cohortDatabaseSchema.@cohortTable",
#                "GROUP BY cohort_definition_id")
#   sql <- render(sql,
#                 cohortDatabaseSchema = cohortDatabaseSchema,
#                 cohortTable = paste0(cohortTable, "_", i))
#   sql <- translate(sql, targetDialect = connectionDetails$dbms)
#   print(querySql(connection, sql))
#   rm(sql)
# }
# 
# for(i in 1:num_cohorts){
#   sql <- paste("SELECT TOP 10 *",
#                "FROM @cohortDatabaseSchema.@cohortTable")
#   sql <- render(sql,
#                 cohortDatabaseSchema = cohortDatabaseSchema,
#                 cohortTable = paste0(cohortTable, "_", i))
#   sql <- translate(sql, targetDialect = connectionDetails$dbms)
#   print(querySql(connection, sql))
#   rm(sql)
# }



# ==================================================================================================================
# Define parameters to develop attribute tables (for CCI components)
# ==================================================================================================================

# From http://mchp-appserv.cpe.umanitoba.ca/concept/Charlson%20Comorbidities%20-%20Coding%20Algorithms%20for%20ICD-9-CM%20and%20ICD-10.pdf

# Define custom variables
sourceConceptIds <- list(c(45605780, 45605779, 45596191, 45596190, 45591454, 45586571,
                           45576865, 45572081, 45572080, 45572079, 45562340, 45557536, 45538370,
                           45533436, 44837099, 44835928, 44835927, 44835926, 44834724, 44834723,
                           44834722, 44834721, 44834720, 44834719, 44834718, 44833561, 44832376,
                           44832375, 44832374, 44832373, 44832372, 44831237, 44831236, 44830079,
                           44828973, 44828972, 44827782, 44826636, 44826635, 44825430, 44825429,
                           44825428, 44824237, 44823111, 44820864, 44820861, 44820860, 44820859,
                           44820858, 44820857, 44819702, 44819701, 44819700, 44819699, 44819698,
                           44819697, 35207685, 35207684, 1569129, 1569128, 1569127, 1569126,
                           1413819, 1413818, 1413817, 1413816, 1413815, 1413814, 1413813,
                           1413812, 1413811, 1413810, 1413809, 1413808, 1413807, 1413806,
                           1413805, 1413804, 1413803, 1413802, 1413801, 1413800, 1413799,
                           1413798, 1413797, 1413796, 1413795, 1413794, 1413793, 1413792,
                           1413791, 1413790, 1413789, 1413788, 1413787, 1413786, 1413785,
                           1326591, 1326590, 1326589, 1326588),
                         c(45605797, 45601038, 45591469, 45591465, 45586588, 45586587,
                           45586582, 45586581, 45586569, 45581779, 45581773, 45576879, 45576878,
                           45576867, 45572090, 45572089, 45572075, 45567181, 45567180, 45567179,
                           45562355, 45562350, 45553639, 45552791, 45552790, 45552780, 45548022,
                           45543182, 45543181, 45533457, 45533456, 45533451, 44835944, 44835943,
                           44835939, 44834732, 44833574, 44833573, 44833557, 44832381, 44831250,
                           44831249, 44831248, 44831230, 44830086, 44827796, 44827795, 44827794,
                           44826642, 44824251, 44824250, 44824235, 44823119, 44823116, 44823110,
                           44823108, 44821955, 44820870, 44820869, 44820856, 44819710, 44819696,
                           44819695, 44819693, 44819692, 35210517, 35207793, 35207792, 35207765,
                           35207764, 35207763, 35207762, 35207761, 35207760, 35207755, 35207704,
                           35207674, 35207673, 35207669, 35207667, 1569181, 1569180, 1569179,
                           1569178, 1424716, 1424715, 1424714, 1414269, 1414268, 1414267,
                           1414266, 1414265, 1414264, 1414263, 1414262, 1414261, 1414260,
                           1414259, 1414258, 1414257, 1414256, 1414255, 1414254, 1414253,
                           1414252, 1414251, 1414250, 1414249, 1414248, 1414120, 1414119,
                           1414118, 1414117, 1414116, 1414115, 1414114, 1414113, 1414112,
                           1414111, 1414110, 1414109, 1414108, 1414107, 1414106, 1414105,
                           1414104, 1414103, 1414102, 1414101, 1414100, 1414099, 1414098,
                           1414085, 1414084, 1413889, 1413888, 1413745, 1413744, 1413741,
                           1413740, 1413728, 1413727, 1413726, 1413725, 1413707, 1413706,
                           1326609, 1326608, 1326607, 1326606, 1326605, 1326604, 1326603,
                           1326602, 1326601, 1326600, 1326599),
                         c(45609999, 45605842, 45605841, 45605840, 45605839, 45605838,
                           45605837, 45605836, 45605835, 45605834, 45605833, 45605832, 45605831,
                           45605830, 45605829, 45605828, 45605178, 45601082, 45601081, 45601080,
                           45601079, 45601078, 45601077, 45601076, 45601075, 45601074, 45601073,
                           45601072, 45601071, 45601070, 45601069, 45601068, 45601067, 45601066,
                           45601065, 45596247, 45596246, 45596245, 45596244, 45596243, 45596242,
                           45596241, 45596240, 45596239, 45596238, 45596237, 45596236, 45596235,
                           45596234, 45596233, 45596232, 45596231, 45596230, 45595565, 45591513,
                           45591511, 45591510, 45591509, 45591508, 45591507, 45591506, 45591505,
                           45591504, 45591503, 45591502, 45591501, 45591500, 45591499, 45591498,
                           45591497, 45591496, 45591495, 45591494, 45586625, 45586624, 45586623,
                           45586622, 45586621, 45586620, 45586619, 45586618, 45586617, 45586616,
                           45586615, 45586614, 45586613, 45581816, 45581813, 45581812, 45581811,
                           45581810, 45581809, 45581808, 45581807, 45581806, 45581805, 45581804,
                           45581803, 45581802, 45581801, 45581800, 45581799, 45581798, 45576915,
                           45576914, 45576913, 45576912, 45576911, 45576910, 45576909, 45576908,
                           45576907, 45576906, 45576905, 45576904, 45576903, 45576221, 45576220,
                           45576219, 45576218, 45576217, 45572130, 45572129, 45572128, 45572127,
                           45572126, 45572125, 45572124, 45572123, 45572122, 45572121, 45572120,
                           45572119, 45572118, 45572117, 45572116, 45567312, 45567223, 45567221,
                           45567220, 45567219, 45567218, 45567217, 45567216, 45567215, 45567214,
                           45567213, 45567212, 45567211, 45567210, 45567209, 45567208, 45567207,
                           45562497, 45562400, 45562399, 45562398, 45562397, 45562396, 45562395,
                           45562394, 45562393, 45562392, 45562391, 45562390, 45562389, 45562388,
                           45562387, 45562386, 45562385, 45557659, 45557589, 45557588, 45557587,
                           45557586, 45557585, 45557584, 45557583, 45557582, 45557581, 45557580,
                           45557579, 45557578, 45557577, 45557576, 45557575, 45557574, 45557573,
                           45557572, 45557571, 45557570, 45557569, 45557568, 45552846, 45552843,
                           45552842, 45552841, 45552840, 45552839, 45552838, 45552837, 45552836,
                           45552835, 45552834, 45552833, 45552832, 45552831, 45552830, 45552829,
                           45552828, 45552827, 45552826, 45552825, 45552824, 45552823, 45548076,
                           45548075, 45548074, 45548073, 45548072, 45548071, 45548070, 45548069,
                           45548068, 45548067, 45548066, 45548065, 45548064, 45548063, 45548062,
                           45548061, 45548060, 45548059, 45548058, 45548057, 45548056, 45543216,
                           45543215, 45543214, 45543213, 45543212, 45543211, 45543210, 45543209,
                           45538444, 45538440, 45538439, 45538438, 45538437, 45538436, 45538435,
                           45538434, 45538433, 45538432, 45538431, 45538430, 45538429, 45538428,
                           45538427, 45538426, 45538425, 45538424, 45538423, 45538422, 45538421,
                           45533505, 45533502, 45533496, 45533495, 45533494, 45533493, 45533492,
                           45533491, 45533490, 45533489, 45533488, 45533487, 45533486, 45533485,
                           45533484, 45533483, 44837117, 44837116, 44835959, 44835958, 44835957,
                           44835640, 44834813, 44834745, 44833581, 44833580, 44833579, 44832392,
                           44831258, 44831257, 44831256, 44830159, 44830094, 44830093, 44828994,
                           44828993, 44828992, 44828991, 44827805, 44827804, 44826657, 44826655,
                           44826651, 44826646, 44825451, 44825449, 44825448, 44825447, 44825446,
                           44824260, 44824259, 44824258, 44824257, 44823126, 44823125, 44823124,
                           44821962, 44820878, 44820429, 44819724, 44819723, 44819721, 44819720,
                           44819719, 44819718, 35225419, 35208278, 35208277, 35208276, 35207881,
                           35207869, 35207860, 35207859, 35207851, 35207850, 35207849, 35207848,
                           35207847, 35207846, 35207845, 35207844, 35207843, 35207842, 35207841,
                           1576289, 1576288, 1576287, 1569326, 1569322, 1569321, 1569320,
                           1569319, 1569318, 1569317, 1569316, 1569315, 1569314, 1569313,
                           1569312, 1569311, 1569310, 1569309, 1569308, 1569307, 1569306,
                           1569305, 1569304, 1569303, 1569302, 1569301, 1569300, 1569299,
                           1569298, 1569297, 1569296, 1569295, 1569294, 1569293, 1569292,
                           1569291, 1569290, 1569289, 1569288, 1569287, 1569286, 1569285,
                           1569284, 1569283, 1569282, 1569281, 1569280, 1569279, 1569278,
                           1569277, 1569276, 1569275, 1569274, 1569273, 1569272, 1435713,
                           1435712, 1435711, 1435710, 1435709, 1417133, 1417132, 1417131,
                           1417130, 1417129, 1417128, 1417127, 1417126, 1417122, 1417121,
                           1417120, 1417119, 1417118, 1417117, 1417116, 1417115, 1414871,
                           1414869, 1414821, 1414820, 1414819, 1414818, 1414817, 1414816,
                           1414815, 1414814, 1414813, 1414812, 1414811, 1414810, 1414809,
                           1414808, 1414807, 1414806, 1414805, 1414804, 1414803, 1414802,
                           1414801, 1414800, 1414799, 1414798, 1414797, 1414796, 1414795,
                           1414794, 1414793, 1414792, 1414791, 1414790, 1414789, 1414717,
                           1414716, 1414715, 1414714, 1414713, 1414712, 1414711, 1414710,
                           1414709, 1414708, 1414707, 1414706, 1414705, 1414653, 1414652,
                           1414651, 1414650, 1414649, 1414648, 1414647, 1414646, 1414645,
                           1414644, 1414643, 1414642, 1414641, 1414640, 1414639, 1414638,
                           1414637, 1414636, 1414635, 1414634, 1414633, 1414632, 1414631,
                           1414630, 1414629, 1414628, 1414627, 1414626, 1414625, 1414624,
                           1414623, 1414622, 1414621, 1414620, 1414619, 1414618, 1414617,
                           1414616, 1414615, 1414614, 1414613, 1414612, 1414611, 1414610,
                           1414609, 1414608, 1414607, 1414606, 1414605, 1414604, 1414603,
                           1414602, 1414601, 1414600, 1414599, 1414598, 1414597, 1414596,
                           1414595, 1414594, 1414593, 1414592, 1414591, 1414590, 1414589,
                           1414588, 1414587, 1414586, 1414585, 1414584, 1414583),
                         c(45755410, 45755407, 45605827, 45605826, 45605825, 45605824,
                           45605823, 45605822, 45605821, 45605820, 45605819, 45605818, 45605817,
                           45605816, 45605815, 45605814, 45605813, 45605812, 45605811, 45605810,
                           45605809, 45605808, 45605807, 45605806, 45605805, 45605804, 45605803,
                           45605802, 45605801, 45605800, 45605555, 45601064, 45601063, 45601062,
                           45601061, 45601060, 45601059, 45601058, 45601057, 45601056, 45601055,
                           45601054, 45601053, 45601052, 45601051, 45601050, 45601049, 45601048,
                           45601047, 45601046, 45601045, 45601044, 45601043, 45601042, 45601041,
                           45600792, 45600791, 45596228, 45596227, 45596226, 45596225, 45596224,
                           45596223, 45596222, 45596221, 45596220, 45596219, 45596218, 45596217,
                           45596216, 45596215, 45596214, 45596213, 45596212, 45596211, 45596068,
                           45591493, 45591492, 45591491, 45591490, 45591489, 45591488, 45591487,
                           45591486, 45591485, 45591484, 45591483, 45591482, 45591481, 45591480,
                           45591479, 45591478, 45591477, 45591476, 45591475, 45591474, 45591473,
                           45591472, 45591471, 45591319, 45586612, 45586611, 45586610, 45586609,
                           45586608, 45586607, 45586606, 45586605, 45586604, 45586603, 45586602,
                           45586601, 45586600, 45586599, 45586598, 45586597, 45586596, 45586595,
                           45586594, 45586593, 45586592, 45586591, 45586590, 45586296, 45581797,
                           45581796, 45581795, 45581794, 45581793, 45581792, 45581791, 45581790,
                           45581789, 45581788, 45581787, 45581786, 45581785, 45581784, 45581783,
                           45581782, 45581781, 45576901, 45576900, 45576899, 45576898, 45576897,
                           45576896, 45576895, 45576894, 45576893, 45576892, 45576891, 45576890,
                           45576889, 45576888, 45576887, 45576886, 45576885, 45576884, 45576883,
                           45576882, 45576881, 45576728, 45576587, 45576586, 45572115, 45572114,
                           45572113, 45572112, 45572111, 45572110, 45572109, 45572108, 45572107,
                           45572106, 45572105, 45572104, 45572103, 45572102, 45572101, 45572100,
                           45572099, 45572098, 45572097, 45572096, 45572095, 45571809, 45567206,
                           45567205, 45567204, 45567203, 45567202, 45567201, 45567200, 45567199,
                           45567198, 45567197, 45567196, 45567195, 45567194, 45567193, 45567192,
                           45567191, 45567190, 45567189, 45567188, 45567187, 45567186, 45567185,
                           45567184, 45566883, 45562384, 45562383, 45562382, 45562381, 45562380,
                           45562379, 45562378, 45562377, 45562376, 45562375, 45562374, 45562373,
                           45562372, 45562371, 45562370, 45562369, 45562368, 45562367, 45562366,
                           45562365, 45562364, 45562363, 45562362, 45562361, 45562360, 45562359,
                           45562358, 45562357, 45562092, 45557567, 45557566, 45557565, 45557564,
                           45557563, 45557562, 45557561, 45557560, 45557559, 45557558, 45557557,
                           45557556, 45557555, 45557554, 45557553, 45557552, 45557551, 45557550,
                           45557549, 45557548, 45557547, 45557546, 45557239, 45552822, 45552821,
                           45552820, 45552819, 45552818, 45552817, 45552816, 45552815, 45552814,
                           45552813, 45552812, 45552811, 45552810, 45552809, 45552808, 45552807,
                           45552806, 45552805, 45552804, 45552803, 45552802, 45552801, 45552800,
                           45552799, 45552798, 45552536, 45552535, 45552534, 45548055, 45548054,
                           45548053, 45548052, 45548051, 45548050, 45548049, 45548048, 45548047,
                           45548046, 45548045, 45548044, 45548043, 45548042, 45548041, 45548040,
                           45548039, 45548038, 45548037, 45548036, 45548035, 45548034, 45548032,
                           45548031, 45548030, 45548029, 45548028, 45548027, 45548026, 45548025,
                           45548024, 45543208, 45543207, 45543206, 45543205, 45543204, 45543203,
                           45543202, 45543201, 45543200, 45543199, 45543198, 45543197, 45543196,
                           45543195, 45543194, 45543193, 45543192, 45543191, 45543190, 45543189,
                           45543188, 45543187, 45543186, 45543185, 45542892, 45538420, 45538419,
                           45538418, 45538417, 45538416, 45538415, 45538414, 45538413, 45538412,
                           45538411, 45538410, 45538409, 45538408, 45538407, 45538406, 45538405,
                           45538404, 45538403, 45538402, 45538401, 45538400, 45538399, 45538398,
                           45538397, 45538396, 45538395, 45538394, 45538393, 45538392, 45538391,
                           45538390, 45538389, 45538388, 45538259, 45538120, 45533482, 45533481,
                           45533480, 45533479, 45533478, 45533477, 45533476, 45533475, 45533474,
                           45533473, 45533472, 45533471, 45533470, 45533469, 45533468, 45533467,
                           45533466, 45533464, 45533463, 45533462, 45533461, 45533460, 45533459,
                           45533458, 45533298, 45533146, 45533145, 44837115, 44837114, 44837113,
                           44837112, 44837111, 44837110, 44835956, 44835955, 44835954, 44835953,
                           44835952, 44835951, 44835950, 44835949, 44835948, 44835947, 44835946,
                           44834741, 44834740, 44834739, 44834738, 44834737, 44834736, 44834735,
                           44833578, 44833577, 44833576, 44832391, 44832390, 44832389, 44832388,
                           44832387, 44832386, 44832385, 44832384, 44831255, 44831254, 44831253,
                           44831252, 44830092, 44830091, 44830090, 44830089, 44830088, 44828990,
                           44828989, 44828988, 44828987, 44828986, 44828985, 44828984, 44828983,
                           44828982, 44827803, 44827802, 44827801, 44827800, 44827799, 44827798,
                           44826650, 44826649, 44826648, 44826647, 44826646, 44826645, 44826644,
                           44825445, 44825444, 44824256, 44824255, 44824254, 44824253, 44824252,
                           44823123, 44823122, 44823121, 44821960, 44821959, 44820877, 44820876,
                           44820875, 44820874, 44820873, 44820872, 44819717, 44819716, 44819715,
                           44819714, 44819713, 44819712, 37200561, 37200560, 37200559, 37200558,
                           37200557, 37200556, 37200555, 37200554, 37200553, 37200552, 37200551,
                           37200550, 37200549, 37200548, 37200547, 37200546, 37200545, 37200544,
                           37200543, 37200542, 37200541, 37200540, 37200539, 37200538, 37200537,
                           37200536, 37200535, 37200534, 37200533, 37200532, 37200531, 37200530,
                           37200529, 37200528, 37200527, 37200526, 37200525, 37200524, 37200523,
                           37200522, 37200521, 37200520, 37200519, 37200518, 37200517, 37200516,
                           37200515, 37200514, 37200513, 37200512, 37200511, 37200510, 37200509,
                           37200508, 37200507, 37200506, 37200505, 37200504, 37200503, 37200502,
                           37200501, 37200500, 37200499, 37200498, 37200497, 37200496, 35207840,
                           35207839, 35207838, 35207837, 35207836, 35207835, 35207834, 35207833,
                           35207832, 35207831, 35207830, 35207829, 35207828, 35207827, 35207826,
                           35207825, 35207824, 35207823, 35207822, 35207821, 35207820, 35207819,
                           35207818, 35207817, 35207816, 35207815, 35207814, 35207813, 35207812,
                           35207811, 35207810, 35207809, 35207808, 35207807, 35207806, 35207805,
                           35207804, 35207803, 35207408, 35207407, 35207406, 35207405, 35207404,
                           35207403, 35207402, 35207401, 35207400, 35207399, 35207398, 35207397,
                           35207396, 35207395, 35207394, 35207393, 1595601, 1595600, 1595599,
                           1595598, 1595597, 1569270, 1569269, 1569268, 1569267, 1569266,
                           1569265, 1569264, 1569263, 1569262, 1569261, 1569260, 1569259,
                           1569258, 1569257, 1569256, 1569255, 1569254, 1569253, 1569252,
                           1569251, 1569250, 1569249, 1569248, 1569247, 1569246, 1569245,
                           1569244, 1569243, 1569242, 1569241, 1569240, 1569239, 1569238,
                           1569237, 1569236, 1569235, 1569234, 1569233, 1569232, 1569231,
                           1569230, 1569229, 1569228, 1569227, 1569226, 1569225, 1569224,
                           1569223, 1569222, 1569221, 1569220, 1569219, 1569218, 1569217,
                           1569216, 1569215, 1569214, 1569213, 1569212, 1569211, 1569210,
                           1569209, 1569208, 1569207, 1569206, 1569205, 1569204, 1569203,
                           1569202, 1569201, 1569200, 1569199, 1569198, 1569197, 1569196,
                           1569195, 1569194, 1569193, 1569192, 1569191, 1569190, 1569189,
                           1569188, 1569187, 1569186, 1569185, 1569184, 1568725, 1568361,
                           1568360, 1435878, 1414581, 1414580, 1414579, 1414578, 1414577,
                           1414576, 1414575, 1414574, 1414573, 1414572, 1414571, 1414570,
                           1414569, 1414568, 1414567, 1414566, 1414565, 1414564, 1414563,
                           1414562, 1414561, 1414560, 1414559, 1414558, 1414557, 1414556,
                           1414555, 1414554, 1414553, 1414552, 1414551, 1414550, 1414549,
                           1414548, 1414547, 1414546, 1414545, 1414544, 1414543, 1414542,
                           1414541, 1414540, 1414539, 1414538, 1414537, 1414536, 1414535,
                           1414534, 1414533, 1414532, 1414531, 1414530, 1414529, 1414528,
                           1414527, 1414526, 1414525, 1414524, 1414523, 1414522, 1414521,
                           1414520, 1414519, 1414518, 1414517, 1414516, 1414515, 1414514,
                           1414513, 1414512, 1414511, 1414510, 1414509, 1414508, 1414507,
                           1414506, 1414505, 1414504, 1414503, 1414502, 1414501, 1414500,
                           1414499, 1414498, 1414497, 1414496, 1414495, 1414494, 1414493,
                           1414492, 1414491, 1414490, 1414489, 1414488, 1414487, 1414486,
                           1414485, 1414484, 1414483, 1414482, 1414481, 1414480, 1414479,
                           1414478, 1414477, 1414476, 1414475, 1414474, 1414473, 1414472,
                           1414471, 1414470, 1414469, 1414468, 1414467, 1414466, 1414465,
                           1414464, 1414463, 1414462, 1414461, 1414460, 1414459, 1414458,
                           1414457, 1414456, 1414455, 1414454, 1414453, 1414452, 1414451,
                           1414450, 1414449, 1414448, 1414447, 1414446, 1414445, 1414444,
                           1414443, 1414442, 1414441, 1414440, 1414439, 1414438, 1414437,
                           1414436, 1414435, 1414434, 1414433, 1414432, 1414431, 1414430,
                           1414429, 1414428, 1414427, 1414426, 1414425, 1414424, 1414423,
                           1414422, 1414421, 1414420, 1414419, 1414418, 1414417, 1414416,
                           1414415, 1414414, 1414413, 1414412, 1414411, 1414410, 1414409,
                           1414408, 1414407, 1414406, 1414405, 1414404, 1414403, 1414402,
                           1414401, 1414400, 1414399, 1414398, 1414397, 1414396, 1414395,
                           1414394, 1414393, 1414392, 1414391, 1414390, 1414389, 1414388,
                           1414387, 1414386, 1414385, 1414384, 1414383, 1414382, 1414381,
                           1414380, 1414379, 1414378, 1414377, 1414376, 1414375, 1414374,
                           1414373, 1414372, 1414371, 1414370, 1414369, 1414368, 1414367,
                           1414366, 1414365, 1414364, 1414363, 1414362, 1414361, 1414360,
                           1414359, 1414358, 1414357, 1414356, 1414355, 1414354, 1414353,
                           1414352, 1414351, 1414350, 1414349, 1414348, 1414347, 1414346,
                           1414345, 1414344, 1414343, 1414342, 1414341, 1414340, 1414339,
                           1414338, 1414337, 1414336, 1414335, 1414334, 1414333, 1414332,
                           1414331, 1414330, 1414329, 1414328, 1414327, 1414326, 1414325,
                           1414324, 1414323, 1414322, 1414321, 1412873, 1412872, 1411741,
                           1411740, 1411739, 1411738, 1411737, 1411736, 1411735, 1411734,
                           1411733, 1411732, 1411731, 1411730, 1411729, 1411728, 1411727,
                           1411726, 1411724, 1411723, 1411722, 1411721, 1411720, 1411719,
                           1411718, 1411717, 1411716, 1411715, 1411714, 1411713, 1411712,
                           1411711, 1411710, 1411709, 1411708, 1411707, 1411706, 1411705,
                           44830001),
                         c(45755371, 45605532, 45605443, 45600684, 45600683, 45595843,
                           45595842, 45591165, 45591076, 45591074, 45591073, 45591070, 45581395,
                           45581394, 45581393, 45576485, 45571701, 45566868, 45566772, 45566770,
                           45561994, 45557226, 45557150, 45557147, 45557146, 45552521, 45552429,
                           45552425, 45538000, 45537999, 45537996, 45533058, 45533052, 44836954,
                           44835773, 44835772, 44834581, 44833397, 44832219, 44831079, 44831078,
                           44829917, 44829915, 44829914, 44827644, 44827641, 44826538, 44824106,
                           44824105, 44821814, 44821811, 44821810, 44820709, 44820708, 44819534,
                           35207360, 35207359, 35207358, 35207357, 35207356, 35207114, 2790620,
                           1568090, 1568089, 1568088, 1568087, 1411510, 1411509, 1411508,
                           1411502, 1411501, 1411500, 1411499, 1411498, 1411497, 1411496,
                           1411495, 1411494, 1411493, 1411492, 1410230, 1410229, 1410228,
                           1410227, 1410226, 1410225, 1410224, 1410223, 1410222, 1410221,
                           1410220, 1410219, 1410218, 1410217, 1410216, 1410215, 1410214,
                           1410213, 1410212, 1410211, 1410210, 1410209, 1410208, 1410207,
                           1410206, 1410205, 1410204, 1410203, 1410202, 1410201),
                         c(45755458, 45755457, 45755456, 45755455, 45605893, 45605892,
                           45605891, 45605890, 45605889, 45605888, 45601134, 45601133, 45601132,
                           45601131, 45601029, 45596284, 45596282, 45591560, 45591559, 45591558,
                           45586678, 45586677, 45586676, 45586675, 45586674, 45586673, 45586672,
                           45586671, 45581861, 45581860, 45581859, 45576956, 45576955, 45576952,
                           45576951, 45576950, 45572173, 45572172, 45572171, 45572170, 45572169,
                           45572168, 45572167, 45567271, 45567270, 45567269, 45567268, 45567266,
                           45567265, 45567264, 45562462, 45562461, 45562460, 45562459, 45562458,
                           45562457, 45562456, 45562454, 45557627, 45557626, 45557625, 45557624,
                           45557541, 45552894, 45552893, 45552892, 45552891, 45552890, 45552889,
                           45548119, 45548118, 45548117, 45548116, 45548115, 45548015, 45543272,
                           45543271, 45543270, 45543269, 45543268, 45543267, 45543266, 45533556,
                           45533555, 45533554, 45533553, 45533552, 45533442, 45533441, 44837138,
                           44837137, 44837136, 44837135, 44837134, 44835986, 44835981, 44835980,
                           44834771, 44834770, 44834769, 44833613, 44833612, 44833611, 44832425,
                           44832424, 44832423, 44832422, 44832421, 44831280, 44831279, 44831278,
                           44830115, 44830114, 44829014, 44829013, 44829012, 44829011, 44829010,
                           44828976, 44827825, 44827824, 44827823, 44827822, 44827786, 44826682,
                           44826681, 44826680, 44826679, 44826678, 44826677, 44825475, 44825474,
                           44824290, 44824289, 44824288, 44824287, 44823145, 44823144, 44821988,
                           44821987, 44821986, 44820892, 44820891, 44820890, 44820889, 44820888,
                           44820887, 44819747, 44510418, 42488402, 35208065, 35208063, 35208056,
                           35208051, 35208050, 35208049, 35208048, 35208047, 35208046, 35208045,
                           35208044, 35208043, 35208042, 35208041, 35208040, 35208039, 35208038,
                           35208037, 35208036, 35208035, 35208034, 35208033, 35208032, 35208031,
                           35208030, 35208029, 35208028, 35208027, 35208026, 35208025, 35208024,
                           35208023, 35208022, 35208021, 35208020, 35208019, 35208018, 35208017,
                           35208016, 35208015, 35208014, 35208013, 35207710, 1569496, 1569495,
                           1569494, 1569493, 1569492, 1569491, 1569490, 1569489, 1569488,
                           1569487, 1569486, 1569485, 1569151, 1435887, 1435886, 1415787,
                           1415786, 1415783, 1415782, 1415781, 1415763, 1415762, 1415747,
                           1415746, 1415745, 1415744, 1415743, 1415742, 1415741, 1415740,
                           1415739, 1415738, 1415737, 1415736, 1415735, 1415734, 1415733,
                           1415732, 1415731, 1415730, 1415729, 1415728, 1415727, 1415726,
                           1415725, 1415724, 1415723, 1415722, 1415721, 1415720, 1415719,
                           1415718, 1415717, 1415716, 1415715, 1415714, 1415713, 1415712,
                           1415711, 1415710, 1415709, 1415708, 1415707, 1415706, 1415705,
                           1415704, 1415703, 1415702, 1415701, 1415700, 1415699, 1415698,
                           1415697, 1415696, 1415695, 1415694, 1415693, 1415692, 1415691,
                           1415690, 1415689, 1415688, 1415687, 1415686, 1415685, 1415684,
                           1415683, 1415682, 1415681, 1415680, 1415679, 1415678, 1415677,
                           1415676, 1415675, 1415674, 1415673, 1415672, 1415671, 1415670,
                           1415669, 1415668, 1415667, 1415666, 1415665, 1415664, 1415663,
                           1415662, 1415661, 1415660, 1415659, 1415658, 1415657, 1415656,
                           1415655, 1415654, 1415653, 1415652, 1415651, 1415650, 1415649,
                           1415648, 1415647, 1415646, 1415645, 1415644, 1415643, 1415642,
                           1415641, 1415640, 1415639, 1415638, 1415637, 1415636, 1415635,
                           1415634, 1415633, 1415632, 1415631, 1415630, 1415629, 1415628,
                           1415627, 1415626, 1415625, 1415624, 1415623, 1415622, 1415621,
                           1415620, 1415619, 1415618, 1415617, 1415616, 1415615, 1415614,
                           1415613, 1415612, 1415611, 1415610, 1415609, 1413922, 1413921,
                           1413920, 1413919, 1401582, 1326598),
                         c(45606214, 45606064, 45606063, 45606062, 45606061, 45606060,
                           45606059, 45606058, 45606057, 45606056, 45606055, 45606054, 45606053,
                           45606052, 45606051, 45606050, 45606049, 45606048, 45606047, 45606046,
                           45606045, 45606044, 45606043, 45606042, 45606041, 45606040, 45606039,
                           45606038, 45601436, 45601435, 45601434, 45601433, 45601289, 45601288,
                           45601287, 45601286, 45601285, 45601284, 45601283, 45601282, 45601281,
                           45601280, 45601279, 45601278, 45601277, 45601276, 45601275, 45601274,
                           45596565, 45596564, 45596562, 45596446, 45596445, 45596444, 45596443,
                           45596442, 45596441, 45596440, 45596439, 45596438, 45596437, 45596436,
                           45596435, 45596434, 45596433, 45596432, 45596431, 45596430, 45596429,
                           45596428, 45596427, 45596426, 45596425, 45591823, 45591822, 45591821,
                           45591820, 45591705, 45591704, 45591703, 45591702, 45591701, 45591700,
                           45591699, 45591698, 45591697, 45591696, 45591695, 45591694, 45591693,
                           45591692, 45591691, 45591690, 45591689, 45591688, 45591687, 45591686,
                           45591685, 45591684, 45586957, 45586956, 45586845, 45586844, 45586843,
                           45586842, 45586841, 45586840, 45586839, 45586838, 45586837, 45586836,
                           45586835, 45586834, 45586833, 45582130, 45582129, 45582128, 45582127,
                           45582126, 45582017, 45582016, 45582015, 45582014, 45582013, 45582012,
                           45582011, 45582010, 45582009, 45582008, 45582007, 45582006, 45582005,
                           45582004, 45582003, 45582002, 45577245, 45577119, 45577118, 45577117,
                           45577116, 45577115, 45577114, 45577113, 45577112, 45577111, 45577110,
                           45577109, 45577108, 45577107, 45577106, 45577105, 45577104, 45577103,
                           45577102, 45577101, 45577100, 45577099, 45577098, 45577097, 45577096,
                           45577095, 45577094, 45577093, 45577092, 45577091, 45577090, 45572448,
                           45572447, 45572446, 45572445, 45572346, 45572345, 45572344, 45572343,
                           45572342, 45572341, 45572340, 45572339, 45572338, 45572337, 45572336,
                           45572335, 45572334, 45572333, 45572332, 45572331, 45572330, 45572329,
                           45572328, 45572327, 45572326, 45567549, 45567548, 45567547, 45567546,
                           45567545, 45567426, 45567425, 45567424, 45567423, 45567422, 45567421,
                           45567420, 45567419, 45567418, 45567417, 45567416, 45567415, 45567414,
                           45567413, 45567412, 45567411, 45567410, 45567409, 45567408, 45567407,
                           45567406, 45567405, 45567404, 45567403, 45562710, 45562709, 45562708,
                           45562600, 45562599, 45562598, 45562597, 45562596, 45562595, 45562594,
                           45562593, 45562592, 45562591, 45562590, 45562589, 45562588, 45562587,
                           45562586, 45562585, 45562584, 45562583, 45562582, 45562581, 45557865,
                           45557864, 45557765, 45557764, 45557763, 45557762, 45557761, 45557760,
                           45557759, 45557758, 45557757, 45557756, 45557755, 45557754, 45557753,
                           45557752, 45553172, 45553171, 45553170, 45553169, 45553168, 45553167,
                           45553053, 45553052, 45553051, 45553050, 45553049, 45553048, 45553047,
                           45553046, 45553045, 45553044, 45553043, 45553042, 45553041, 45553040,
                           45553039, 45553038, 45553037, 45553036, 45548402, 45548271, 45548270,
                           45548269, 45548268, 45548267, 45548266, 45548265, 45548264, 45548263,
                           45548262, 45548261, 45548260, 45548259, 45548258, 45548257, 45548256,
                           45548255, 45548254, 45548253, 45548252, 45548251, 45548250, 45548249,
                           45548248, 45543443, 45543442, 45543441, 45543440, 45543439, 45543438,
                           45543437, 45543436, 45543435, 45543434, 45543433, 45543432, 45543431,
                           45543430, 45543429, 45543428, 45538753, 45538639, 45538638, 45538637,
                           45538636, 45538635, 45538634, 45538633, 45538632, 45538631, 45538630,
                           45538629, 45538628, 45538627, 45538626, 45538625, 45538624, 45538623,
                           45538622, 45533830, 45533828, 45533827, 45533826, 45533825, 45533705,
                           45533704, 45533703, 45533702, 45533701, 45533700, 45533699, 45533698,
                           45533697, 45533696, 45533695, 45533694, 45533693, 45533692, 45533691,
                           45533690, 45533689, 44837334, 44836170, 44834963, 44833584, 44832628,
                           44832613, 44831518, 44831487, 44831474, 44828021, 44828020, 44826868,
                           44825676, 44821123, 44819941, 42619380, 42619379, 42619376, 42619375,
                           42619374, 42616652, 42616651, 42616650, 42616649, 42616648, 42616647,
                           42616646, 42616645, 42616644, 42616643, 42616642, 42616641, 42616640,
                           42616639, 42616638, 42616637, 42616636, 42616635, 42616634, 42616633,
                           42616632, 42616631, 42616630, 42616629, 42616628, 42616627, 42616626,
                           42616625, 42616624, 42616623, 42616622, 42616621, 42616620, 42616619,
                           42616618, 42616617, 42616616, 42616615, 42616614, 42616613, 42616612,
                           42616611, 42616610, 42616609, 42616608, 42616607, 42616606, 42616605,
                           42616604, 42616603, 42616602, 42616601, 42616600, 42616599, 42616598,
                           42616597, 42616596, 42616595, 42616594, 42616593, 42616592, 42616591,
                           42616590, 42616589, 42616588, 42616587, 42616586, 42616585, 42616584,
                           42616583, 42616582, 42616581, 42616580, 42616579, 42616578, 42616577,
                           42616576, 42616575, 42616574, 42616573, 42616572, 42616571, 42616570,
                           42616569, 42616568, 42616567, 42616566, 42616565, 42616564, 42616563,
                           42616562, 42616561, 42616560, 42616559, 42616558, 42616557, 42616556,
                           42616555, 42616554, 42616553, 42616552, 42616551, 42616550, 42616549,
                           42616548, 42616547, 42616546, 42616545, 42616544, 42616543, 42616542,
                           42616541, 42616540, 42616539, 42616538, 42616537, 42616536, 42616535,
                           42616534, 42616533, 42616532, 42616531, 42616530, 42616529, 42616528,
                           35208841, 35208834, 35208832, 35208831, 35208830, 35208829, 35208828,
                           35208827, 35208826, 35208825, 35208820, 35208753, 35208752, 35208751,
                           35208750, 1570620, 1570619, 1570618, 1570617, 1570616, 1570615,
                           1570614, 1570613, 1570612, 1570071, 1570070, 1570069, 1570068,
                           1570067, 1570066, 1570065, 1570064, 1570063, 1570062, 1570061,
                           1570060, 1570059, 1570058, 1570057, 1570056, 1570055, 1570054,
                           1570053, 1570052, 1570051, 1570050, 1570049, 1570048, 1570047,
                           1570046, 1570045, 1570044, 1570043, 1570042, 1570041, 1570040,
                           1570039, 1570038, 1570037, 1570036, 1570035, 1570034, 1570033,
                           1570032, 1570031, 1570030, 1570029, 1570028, 1570027, 1570026,
                           1570025, 1570024, 1570023, 1570022, 1570021, 1570020, 1570019,
                           1570018, 1570017, 1570016, 1570015, 1570014, 1570013, 1570012,
                           1570011, 1570010, 1570009, 1570008, 1570007, 1570006, 1570005,
                           1570004, 1570003, 1570002, 1570001, 1570000, 1569999, 1569998,
                           1569997, 1569996, 1569995, 1569994, 1569993, 1569992, 1569991,
                           1569990, 1569989, 1569988, 1569987, 1569986, 1569985, 1569984,
                           1569983, 1569982, 1569981, 1569980, 1569979, 1569978, 1569977,
                           1569976, 1569975, 1569974, 1569973, 1569972, 1569971, 1569970,
                           1569969, 1569968, 1569967, 1569966, 1419861, 1419835, 1419834,
                           1419828, 1419827, 1419826, 1419813, 1419812, 1419811, 1419810,
                           1419809, 1419808, 1419807, 1419806, 1419805, 1419804, 1419803,
                           1419802, 1419801, 1419800, 1419799, 1419798, 1419797, 1419796,
                           1419795, 1419794, 1419793, 1419792, 1419791, 1419790, 1419789,
                           1419788, 1419787, 1419786, 1419785, 1419784, 1419783, 1419782,
                           1419781, 1419780, 1419779, 1419778, 1419777, 1419776, 1419775,
                           1419774, 1419773, 1419772, 1419771, 1419770, 1419769, 1419768,
                           1419767, 1419766, 1419765, 1419764, 1419763, 1419762, 1419761,
                           1419760, 1419759, 1419758, 1419757, 1419756, 1419741, 1419740,
                           1419148, 1419147, 1419146, 1419145, 1419144, 1419143, 1419142,
                           1419141, 1419140, 1419139, 1419138, 1419137, 1419136, 1419135,
                           1419134, 1419133, 1419132, 1419131, 1419130, 1419129, 1419128,
                           1419127, 1419126, 1419125, 1419124, 1419123, 1419122, 1419121,
                           1419120, 1419119, 1419118, 1419117, 1419116, 1419115, 1419114,
                           1419113, 1419112, 1419111, 1419110, 1419109, 1419108, 1419107,
                           1419106, 1419105, 1419104, 1419103, 1419102, 1419101, 1419100,
                           1409817, 1409481, 1326706, 1326705, 1326704),
                         c(45605927, 45605926, 45601164, 45601163, 45601162, 45601161,
                           45601160, 45601159, 45601158, 45601157, 45596314, 45596313, 45596312,
                           45596311, 45596310, 45591581, 45586709, 45581891, 45581890, 45581889,
                           45576983, 45572202, 45572201, 45557648, 45552921, 45552920, 45552919,
                           45552918, 45548153, 45548152, 45548151, 45543297, 45538516, 45538515,
                           45538514, 45538513, 45538512, 45533584, 45533583, 45533582, 44837162,
                           44837161, 44837160, 44837159, 44836014, 44836013, 44836012, 44836011,
                           44836010, 44834802, 44834801, 44834800, 44834799, 44834798, 44833640,
                           44833639, 44833638, 44833637, 44833636, 44833635, 44833634, 44833633,
                           44832458, 44832457, 44832456, 44832455, 44832454, 44832453, 44832452,
                           44831305, 44831304, 44831303, 44831302, 44831301, 44831300, 44830147,
                           44830146, 44830145, 44830144, 44830143, 44830142, 44830141, 44830140,
                           44830139, 44830138, 44829035, 44829034, 44829033, 44827862, 44827861,
                           44827860, 44827859, 44827858, 44827857, 44827856, 44827855, 44826708,
                           44826707, 44826706, 44826705, 44826704, 44826703, 44826702, 44825514,
                           44825513, 44825512, 44825511, 44825510, 44825509, 44825508, 44825507,
                           44825506, 44825505, 44825504, 44825503, 44825502, 44824318, 44824317,
                           44824316, 44824315, 44824314, 44824313, 44823171, 44823170, 44823169,
                           44823168, 44823167, 44823166, 44823165, 44822022, 44822021, 44822020,
                           44820937, 44820936, 44820935, 44820934, 44820933, 44820932, 44820931,
                           44820930, 44820929, 44820928, 44820927, 44819787, 44819786, 44819785,
                           44819784, 44819783, 44819782, 44819781, 44819780, 44819779, 35208236,
                           35208235, 35208234, 35208233, 35208232, 35208231, 35208230, 35208229,
                           35208228, 35208227, 35208226, 35208225, 35208224, 35208223, 35208222,
                           35208221, 35208220, 35208219, 35208218, 35208217, 35208216, 35208215,
                           35208214, 35208213, 35208212, 35208211, 35208210, 35208209, 35208208,
                           35208207, 35208206, 35208205, 35208204, 35208203, 35208202, 35208201,
                           1569565, 1569564, 1569563, 1569562, 1416739, 1416738, 1416737,
                           1416736, 1416735, 1416734, 1416733, 1416732, 1416731, 1416730,
                           1416729, 1416728, 1416727, 1416726, 1416725, 1416724, 1416723,
                           1416722, 1416721, 1416720, 1416719, 1416718, 1416717, 1416716,
                           1416715, 1416714, 1416713, 1416712, 1416711, 1416710, 1416709,
                           1416708, 1416707, 1416706, 1416705, 1416704, 1416703, 1416702,
                           1416701, 1416700, 1416699, 1416698, 1416697, 1416696, 1416695,
                           1416694, 1416693, 1416692, 1416691, 1416690, 1416689, 1416688,
                           1416687, 1416686, 1416685, 1416684, 1416683, 1416682, 1416681,
                           1416680, 1416679, 1416678, 1416677, 1416676, 1416675, 1416674,
                           1416673, 1416672, 1416671, 1416670, 1416669, 1416668, 1416667,
                           1416666, 1416665, 1416664, 1416663, 1416662, 1416661, 1416660,
                           1416659, 1416658, 1416657, 1416656, 1416655, 1416654, 1416653,
                           1416652, 1416651, 1416650, 1416649, 1416648, 1416647, 1416646,
                           1416645, 1416644),
                         c(45755467, 45605957, 45605953, 45605952, 45601189, 45601187,
                           45600448, 45596344, 45596343, 45591606, 45590846, 45586733, 45586732,
                           45586731, 45581912, 45572233, 45572232, 45572229, 45572228, 45572227,
                           45572225, 45567325, 45567323, 45566538, 45566478, 45562511, 45562510,
                           45562507, 45557676, 45557669, 45557668, 45552949, 45552946, 45548170,
                           45548169, 45547441, 45547440, 45543340, 45543337, 45543335, 45542555,
                           45538546, 45538545, 45533615, 45533614, 44837177, 44836029, 44835626,
                           44833242, 44832480, 44832478, 44832477, 44832476, 44831320, 44830943,
                           44830167, 44829754, 44829751, 44829749, 44829055, 44827879, 44827878,
                           44826726, 44825528, 44824336, 44824334, 44823185, 44821690, 44821549,
                           44820955, 44819803, 44819802, 44819379, 35225408, 35208368, 35208367,
                           35208363, 35208362, 35208361, 35208359, 35208351, 35208350, 35208349,
                           35208348, 35208347, 35208346, 35208345, 35208344, 35208343, 35208342,
                           35208341, 35208338, 35208335, 35208332, 35208331, 35208330, 35205773,
                           35205772, 35205771, 35205770, 35205769, 1569682, 1569681, 1569680,
                           1569675, 1569671, 1569670, 1567376, 1435681, 1435680, 1417654,
                           1417653, 1417652, 1417651, 1417650, 1417649, 1417648, 1417647,
                           1417646, 1417645, 1417644, 1417643, 1417642, 1417641, 1417640,
                           1417639, 1417638, 1417637, 1417636, 1417626, 1417625, 1417624,
                           1417623, 1417622, 1417621, 1417620, 1417615, 1417614, 1417588,
                           1417587, 1417586, 1417585, 1417584, 1417583, 1417582, 1417581,
                           1417580, 1417579, 1417578, 1417577, 1417576, 1417575, 1417574,
                           1417573, 1417572, 1417571, 1417570, 1417569, 1417568, 1417567,
                           1417566, 1417565, 1417564, 1417563, 1417562, 1417561, 1417560,
                           1417559, 1417558, 1417557, 1417556, 1417555, 1417554, 1417553,
                           1417552, 1417551, 1417550, 1417549, 1417548, 1417547, 1417546,
                           1417545, 1417544, 1417543, 1417542, 1417541, 1417540, 1417539,
                           1417519, 1417518, 1417517, 1417516, 1417512, 1417511, 1417508,
                           1417507, 1417494, 1417493, 1417492, 1417486, 1417485, 1417484,
                           1417483, 1417482, 1417481, 1417480, 1417479, 1417478, 1417477,
                           1417476, 1417475, 1404562, 1404561, 1404560, 1404559, 1404558,
                           1404557, 1404556, 1404555, 1404554, 1404553, 1404552, 1404551,
                           1404550, 1404549, 1404548, 1404547, 1404546, 1404545, 1404544,
                           1404543, 1404542, 1404541, 1404540, 1404539, 1404538, 1404537,
                           1404536, 1404535, 1404534, 1404533, 1404532, 1404531, 1404530,
                           1404529, 1404528, 1404527, 1404526, 1404525),
                         c(45755356, 45755355, 45605408, 45605405, 45605398, 45600644,
                           45600642, 45600641, 45600640, 45600639, 45600636, 45595805, 45595800,
                           45595799, 45591035, 45591031, 45586145, 45586144, 45586140, 45586139,
                           45581359, 45581358, 45581357, 45581355, 45581351, 45581350, 45576449,
                           45576446, 45576441, 45576440, 45571662, 45566739, 45566738, 45566737,
                           45566736, 45566733, 45566731, 45566729, 45561959, 45561958, 45561954,
                           45561953, 45561952, 45561951, 45561949, 45557116, 45557115, 45557111,
                           45557110, 45552387, 45552384, 45552383, 45547636, 45547630, 45547629,
                           45547627, 45547626, 45547624, 45547623, 45542740, 45542739, 45542738,
                           45542735, 45537964, 45537960, 45537959, 45533024, 45533023, 45533018,
                           44836918, 44836917, 44836916, 44836915, 44836914, 44834548, 44833368,
                           44832193, 44832192, 44832191, 44832190, 44831047, 44829882, 44829881,
                           44829878, 44828793, 44827617, 44826461, 44826460, 44826459, 44824073,
                           44824072, 44824071, 44822934, 44821787, 44820685, 44820683, 44820682,
                           44819504, 44819503, 35206885, 35206884, 35206883, 35206882, 35206881,
                           35206880, 35206879, 35206878, 35206877, 1567988, 1567987, 1567986,
                           1567985, 1567984, 1567974, 1567973, 1567971, 1567970, 1567969,
                           1567968, 1567967, 1567957, 1567955, 1567954, 1567953, 1567952,
                           1567951, 1567941, 1409267, 1409266, 1409265, 1409264, 1409261,
                           1409260, 1409251, 1409250, 1409249, 1409248, 1409246, 1409245,
                           1409244, 1409243, 1409242, 1409241, 1409240, 1409239, 1409238,
                           1409237, 1409236, 1409233, 1409232, 1409222, 1409221, 1409220,
                           1409219, 1409218, 1409217, 1409215, 1409214, 1409213, 1409212,
                           1409209, 1409208, 1409199, 1409198, 1409197, 1409196, 1409194,
                           1409193, 1409192, 1409191, 1409188, 1409187, 1409186, 1409185,
                           1409184, 1409160, 1409159, 1409158, 1409157, 1409156, 1409155,
                           1409154, 1409153, 1409152, 1409151, 1409149, 1409148, 1409147,
                           1409146, 1409145, 1409142, 1409141, 1409140, 1409139, 1409138,
                           1409115, 1409114, 1409113, 1409112, 1409111, 1409110, 1409109,
                           1409108, 1409107, 1409106, 1326493, 1326492, 1326491),
                         c(45605407, 45605406, 45605404, 45605403, 45605402, 45605401,
                           45605400, 45605397, 45600646, 45600643, 45600638, 45600637, 45595804,
                           45595803, 45595802, 45595798, 45595797, 45595796, 45595795, 45595794,
                           45595793, 45591036, 45591034, 45591033, 45591032, 45591030, 45591029,
                           45591028, 45591027, 45591026, 45586143, 45586142, 45586138, 45586137,
                           45581354, 45581353, 45581352, 45581349, 45576448, 45576447, 45576445,
                           45576443, 45576442, 45576439, 45576438, 45576437, 45571664, 45571661,
                           45571660, 45571659, 45571658, 45571657, 45571655, 45571654, 45566735,
                           45566734, 45561957, 45561956, 45561955, 45561950, 45561948, 45561947,
                           45557114, 45557113, 45557112, 45552388, 45552386, 45552385, 45552382,
                           45552381, 45552380, 45552379, 45547638, 45547637, 45547635, 45547634,
                           45547633, 45547632, 45547631, 45547628, 45547625, 45547622, 45547621,
                           45542742, 45542741, 45542737, 45542736, 45537963, 45537962, 45537961,
                           45537958, 45533022, 45533021, 45533020, 45533019, 45533017, 45533016,
                           44834549, 44833367, 44833366, 44832194, 44831046, 44831045, 44829880,
                           44829879, 44828795, 44828794, 44827616, 44827615, 44825264, 44824074,
                           44822936, 44822935, 44820684, 44819502, 44819501, 44819500, 37200311,
                           37200310, 37200309, 37200308, 37200307, 37200306, 37200305, 37200304,
                           37200303, 37200302, 37200301, 37200300, 37200299, 37200298, 37200297,
                           37200296, 37200295, 37200294, 37200293, 37200292, 37200291, 37200290,
                           37200289, 37200288, 37200287, 37200286, 37200285, 37200284, 37200283,
                           37200282, 37200281, 37200280, 37200279, 37200278, 37200277, 37200276,
                           37200275, 37200274, 37200273, 37200272, 37200271, 37200270, 37200269,
                           37200268, 37200267, 37200266, 37200265, 37200264, 37200263, 37200262,
                           37200261, 37200260, 37200259, 37200258, 37200257, 37200256, 37200255,
                           37200254, 37200253, 37200252, 37200251, 37200250, 37200249, 37200248,
                           37200247, 37200246, 37200245, 37200244, 37200243, 37200242, 37200241,
                           37200240, 37200239, 37200238, 37200237, 37200236, 37200235, 37200234,
                           37200233, 37200232, 37200231, 37200230, 37200229, 37200228, 37200227,
                           37200226, 37200225, 37200224, 37200223, 37200222, 37200221, 37200220,
                           37200219, 37200218, 37200217, 37200216, 37200215, 37200214, 37200213,
                           37200212, 37200211, 37200210, 37200209, 37200208, 37200207, 37200206,
                           37200205, 37200204, 37200203, 37200202, 37200201, 37200200, 37200199,
                           37200198, 37200197, 37200196, 37200195, 37200194, 37200193, 37200192,
                           37200191, 37200190, 37200189, 37200188, 37200187, 37200186, 37200185,
                           37200184, 37200183, 37200182, 37200181, 37200180, 37200179, 37200178,
                           37200177, 37200176, 37200175, 37200174, 37200173, 37200172, 37200171,
                           37200170, 37200169, 37200168, 37200167, 37200166, 37200165, 37200164,
                           37200163, 37200162, 37200161, 37200160, 37200159, 37200158, 37200157,
                           37200156, 37200155, 37200154, 37200153, 37200152, 37200151, 37200150,
                           37200149, 37200148, 37200147, 37200146, 37200145, 37200144, 37200143,
                           37200142, 37200141, 1567983, 1567982, 1567981, 1567980, 1567979,
                           1567978, 1567977, 1567976, 1567975, 1567966, 1567965, 1567964,
                           1567963, 1567962, 1567961, 1567960, 1567959, 1567958, 1567950,
                           1567949, 1567948, 1567947, 1567946, 1567945, 1567944, 1567943,
                           1567942, 1409263, 1409262, 1409259, 1409258, 1409257, 1409256,
                           1409255, 1409254, 1409253, 1409252, 1409235, 1409234, 1409231,
                           1409230, 1409229, 1409228, 1409227, 1409226, 1409225, 1409224,
                           1409223, 1409211, 1409210, 1409207, 1409206, 1409205, 1409204,
                           1409203, 1409202, 1409201, 1409200, 1409190, 1409189, 1409183,
                           1409182, 1409181, 1409180, 1409179, 1409178, 1409177, 1409176,
                           1409175, 1409174, 1409173, 1409172, 1409171, 1409170, 1409169,
                           1409168, 1409167, 1409166, 1409165, 1409164, 1409163, 1409162,
                           1409161, 1409144, 1409143, 1409137, 1409136, 1409135, 1409134,
                           1409133, 1409132, 1409131, 1409130, 1409129, 1409128, 1409127,
                           1409126, 1409125, 1409124, 1409123, 1409122, 1409121, 1409120,
                           1409119, 1409118, 1409117, 1409116),
                         c(45755388, 45605573, 45600810, 45600809, 45600808, 45600807,
                           45600806, 45595962, 45595961, 45591198, 45591197, 45591196, 45591195,
                           45586317, 45586316, 45586315, 45586271, 45581516, 45581515, 45576612,
                           45576610, 45576609, 45571833, 45571832, 45571831, 45571830, 45571829,
                           45571828, 45571827, 45571826, 45566905, 45566904, 45566903, 45566902,
                           45562108, 45562107, 45562106, 45562105, 45557260, 45557259, 45557258,
                           45557257, 45552550, 45552549, 45552548, 45547762, 45547760, 45542910,
                           45542909, 45542908, 45542907, 45542906, 45538142, 45538140, 45538139,
                           45538138, 45533170, 45533169, 45533130, 44837011, 44837010, 44835837,
                           44835836, 44835835, 44834632, 44834631, 44834630, 44833443, 44833442,
                           44833441, 44832278, 44832277, 44832276, 44832275, 44832266, 44829970,
                           44829969, 44829968, 44829967, 44829966, 44828875, 44828873, 44828872,
                           44828871, 44828870, 44828869, 44828868, 44827696, 44827695, 44826553,
                           44826552, 44825336, 44825335, 44825334, 44824159, 44824158, 44824157,
                           44823024, 44823023, 44823022, 44823021, 44823019, 44821853, 44820764,
                           44820763, 44819585, 44819584, 35207488, 35207487, 35207486, 35207481,
                           35207480, 35207319, 35207306, 1568418, 1568417, 1568416, 1568414,
                           1568413, 1568412, 1568411, 1568410, 1568409, 1568408, 1412159,
                           1412158, 1412157, 1412151, 1412150, 1412149, 1412148, 1412147,
                           1412146, 1412145, 1412144, 1412143, 1412142, 1412140, 1412139,
                           1412138, 1412137, 1412136, 1412135, 1412134, 1412133, 1412132,
                           1412131, 1412130, 1412129, 1412128, 1412127, 1412126, 1412125,
                           1412124, 1412123, 1412122, 1412121, 1412120, 1412119, 1412118,
                           1412117, 1412116, 1412115, 1412114, 1412113, 1412112, 1412111,
                           1412095, 1412094, 1412093, 1412092, 1412091, 1411350, 1411349,
                           1411268, 1411267),
                         c(45609945, 45601717, 45596852, 45596188, 45596187, 45592122,
                           45587234, 45585835, 45582394, 45582393, 45582392, 45582391, 45582389,
                           45582388, 45581097, 45576160, 45572694, 45572076, 45571361, 45567833,
                           45566477, 45563001, 45563000, 45553438, 45553437, 45548653, 45548642,
                           45543858, 45543164, 45539026, 45537649, 45534123, 45534119, 45534118,
                           44837192, 44837191, 44837188, 44837187, 44837186, 44836035, 44836034,
                           44835497, 44835496, 44835472, 44834830, 44834280, 44833560, 44833131,
                           44833130, 44831947, 44831328, 44831327, 44831326, 44831325, 44831232,
                           44831231, 44830173, 44830172, 44829650, 44829649, 44829062, 44828971,
                           44827889, 44827888, 44827887, 44825539, 44825538, 44824342, 44824341,
                           44824340, 44824235, 44822716, 44821950, 44821578, 44821546, 44820970,
                           44820856, 44819814, 44819693, 35225436, 35225404, 35209291, 35209280,
                           35209279, 35209278, 35209277, 35209276, 35209275, 35209274, 35209222,
                           35209221, 35209220, 35209219, 35209218, 35209217, 35209202, 35209201,
                           35209200, 35209199, 35209198, 35209197, 35207671, 1576114, 1571486,
                           1569123, 1435775, 1435774, 1435773, 1435673, 1435672, 1435671,
                           1435670, 1434859, 1434858, 1434857, 1434856, 1434855, 1434854,
                           1434853, 1434852, 1421702, 1421701, 1421700, 1421699, 1421698,
                           1421697, 1421667, 1421666, 1421665, 1421664, 1421663, 1421662,
                           1421661, 1421660, 1421659, 1421658, 1421657, 1421656, 1421655,
                           1421654, 1421653, 1421652, 1421651, 1421650, 1421649, 1421648,
                           1421647, 1421646, 1421645, 1421644, 1421474, 1421473, 1421472,
                           1421471, 1421470, 1421469, 1421468, 1421467, 1421466, 1421465,
                           1421464, 1421463, 1421462, 1421461, 1421460, 1421419, 1421418,
                           1421417, 1421416, 1421415, 1421414, 1421413, 1421412, 1421411,
                           1421410, 1421409, 1421408, 1421407, 1421406, 1421405, 1421404,
                           1413743, 1413742, 1413734, 1413733),
                         c(45755352, 45755351, 45755350, 45755349, 45755348, 45755347,
                           45755345, 45755344, 45755343, 45755342, 45755340, 45755339, 45755330,
                           45755329, 45755318, 45755317, 45755316, 45755315, 45755314, 45755313,
                           45605335, 45605334, 45605333, 45605332, 45605331, 45605330, 45605329,
                           45605327, 45605326, 45605325, 45605324, 45605323, 45605322, 45605321,
                           45605320, 45605319, 45605318, 45605317, 45605316, 45605315, 45605314,
                           45605313, 45605312, 45605311, 45605310, 45605309, 45605308, 45605307,
                           45605306, 45605305, 45605304, 45605303, 45605302, 45605301, 45605300,
                           45605299, 45605298, 45605297, 45605296, 45605295, 45605294, 45605293,
                           45605292, 45605287, 45605286, 45605285, 45605284, 45605283, 45605282,
                           45605281, 45605280, 45605279, 45605278, 45605277, 45605276, 45605274,
                           45605273, 45605271, 45605270, 45605269, 45605268, 45605267, 45605266,
                           45605265, 45605264, 45605263, 45605262, 45605261, 45605260, 45605259,
                           45605258, 45605257, 45605256, 45600573, 45600572, 45600571, 45600570,
                           45600569, 45600568, 45600567, 45600566, 45600565, 45600564, 45600563,
                           45600562, 45600560, 45600559, 45600558, 45600557, 45600556, 45600555,
                           45600554, 45600553, 45600552, 45600551, 45600550, 45600549, 45600548,
                           45600547, 45600546, 45600545, 45600544, 45600543, 45600542, 45600541,
                           45600540, 45600539, 45600538, 45600537, 45600536, 45600535, 45600525,
                           45600524, 45600523, 45600522, 45600521, 45600520, 45600519, 45600518,
                           45600517, 45600516, 45600515, 45600514, 45600512, 45600511, 45600510,
                           45600509, 45600508, 45600507, 45600503, 45600502, 45600488, 45600487,
                           45600486, 45600485, 45600484, 45600483, 45600482, 45600481, 45600480,
                           45600479, 45600477, 45600476, 45600475, 45595727, 45595726, 45595725,
                           45595724, 45595723, 45595722, 45595721, 45595720, 45595719, 45595718,
                           45595717, 45595716, 45595715, 45595714, 45595713, 45595712, 45595711,
                           45595710, 45595709, 45595708, 45595707, 45595706, 45595705, 45595704,
                           45595703, 45595702, 45595701, 45595700, 45595699, 45595698, 45595697,
                           45595696, 45595695, 45595694, 45595684, 45595683, 45595682, 45595681,
                           45595680, 45595679, 45595678, 45595677, 45595674, 45595673, 45595672,
                           45595671, 45595670, 45595669, 45595668, 45595667, 45595666, 45595663,
                           45595662, 45595661, 45595660, 45595659, 45595658, 45595652, 45595651,
                           45595650, 45595649, 45595648, 45595647, 45595646, 45595645, 45595644,
                           45595643, 45595642, 45595641, 45595640, 45595639, 45595638, 45595637,
                           45595636, 45595635, 45595634, 45595633, 45590969, 45590968, 45590967,
                           45590966, 45590965, 45590964, 45590963, 45590962, 45590960, 45590959,
                           45590958, 45590957, 45590956, 45590955, 45590954, 45590953, 45590952,
                           45590951, 45590950, 45590949, 45590948, 45590947, 45590946, 45590945,
                           45590944, 45590943, 45590942, 45590941, 45590940, 45590939, 45590938,
                           45590937, 45590936, 45590935, 45590934, 45590933, 45590932, 45590931,
                           45590930, 45590929, 45590928, 45590924, 45590923, 45590922, 45590921,
                           45590920, 45590919, 45590918, 45590917, 45590916, 45590915, 45590914,
                           45590913, 45590911, 45590910, 45590909, 45590908, 45590907, 45590904,
                           45590890, 45590889, 45590888, 45590887, 45590886, 45590885, 45590884,
                           45590883, 45590882, 45590881, 45590880, 45590879, 45590878, 45590877,
                           45590876, 45590875, 45586074, 45586073, 45586072, 45586071, 45586070,
                           45586069, 45586068, 45586067, 45586066, 45586065, 45586064, 45586063,
                           45586062, 45586061, 45586060, 45586059, 45586058, 45586057, 45586056,
                           45586055, 45586054, 45586053, 45586052, 45586051, 45586050, 45586049,
                           45586048, 45586047, 45586046, 45586045, 45586044, 45586043, 45586042,
                           45586041, 45586040, 45586039, 45586038, 45586037, 45586036, 45586035,
                           45586034, 45586033, 45586032, 45586031, 45586030, 45586026, 45586025,
                           45586024, 45586023, 45586022, 45586021, 45586020, 45586019, 45586018,
                           45586017, 45586016, 45586015, 45586014, 45586013, 45586012, 45586011,
                           45586010, 45586007, 45585993, 45585992, 45585991, 45585990, 45585989,
                           45585988, 45585987, 45585986, 45585984, 45585982, 45585981, 45581267,
                           45581266, 45581265, 45581264, 45581263, 45581262, 45581261, 45581260,
                           45581259, 45581258, 45581257, 45581256, 45581255, 45581254, 45581253,
                           45581252, 45581251, 45581250, 45581249, 45581248, 45581247, 45581246,
                           45581245, 45581244, 45581243, 45581242, 45581241, 45581240, 45581239,
                           45581238, 45581237, 45581236, 45581235, 45581234, 45581233, 45581232,
                           45581231, 45581230, 45581229, 45581228, 45581227, 45581226, 45581225,
                           45581224, 45581223, 45581222, 45581221, 45581220, 45581219, 45581218,
                           45581211, 45581210, 45581209, 45581208, 45581207, 45581206, 45581205,
                           45581204, 45581203, 45581202, 45581201, 45581200, 45581199, 45581198,
                           45581197, 45576371, 45576370, 45576369, 45576368, 45576367, 45576366,
                           45576365, 45576364, 45576363, 45576362, 45576361, 45576360, 45576359,
                           45576358, 45576357, 45576356, 45576355, 45576354, 45576353, 45576352,
                           45576351, 45576350, 45576349, 45576348, 45576347, 45576346, 45576345,
                           45576344, 45576337, 45576336, 45576335, 45576334, 45576333, 45576332,
                           45576330, 45576329, 45576328, 45576327, 45576326, 45576325, 45576324,
                           45576323, 45576320, 45576319, 45576318, 45576317, 45576312, 45576311,
                           45576310, 45576309, 45576308, 45576307, 45576306, 45576305, 45576304,
                           45576303, 45576302, 45576301, 45576300, 45576298, 45576297, 45576296,
                           45576295, 45576294, 45571579, 45571578, 45571577, 45571576, 45571575,
                           45571574, 45571573, 45571572, 45571571, 45571570, 45571569, 45571568,
                           45571567, 45571565, 45571564, 45571563, 45571562, 45571561, 45571560,
                           45571559, 45571558, 45571557, 45571556, 45571555, 45571554, 45571553,
                           45571552, 45571551, 45571550, 45571549, 45571548, 45571547, 45571546,
                           45571545, 45571544, 45571537, 45571536, 45571535, 45571534, 45571533,
                           45571532, 45571531, 45571530, 45571529, 45571528, 45571527, 45571525,
                           45571524, 45571523, 45571522, 45571521, 45571520, 45571519, 45571518,
                           45571515, 45571514, 45571513, 45571512, 45571511, 45571510, 45571502,
                           45571501, 45571500, 45571499, 45571498, 45571497, 45571496, 45571495,
                           45571494, 45571493, 45571492, 45571491, 45571490, 45571489, 45571488,
                           45571487, 45566652, 45566651, 45566650, 45566649, 45566648, 45566647,
                           45566645, 45566644, 45566643, 45566642, 45566641, 45566640, 45566639,
                           45566638, 45566637, 45566636, 45566635, 45566634, 45566633, 45566632,
                           45566631, 45566630, 45566629, 45566628, 45566627, 45566626, 45566625,
                           45566624, 45566623, 45566622, 45566621, 45566617, 45566616, 45566615,
                           45566614, 45566613, 45566612, 45566611, 45566610, 45566609, 45566608,
                           45566607, 45566606, 45566605, 45566604, 45566603, 45566602, 45566601,
                           45566600, 45566599, 45566598, 45566596, 45566595, 45566594, 45566593,
                           45566592, 45566591, 45566585, 45566584, 45566583, 45566582, 45566581,
                           45566580, 45566579, 45566578, 45566577, 45566576, 45566575, 45566574,
                           45566572, 45566571, 45566570, 45566569, 45561882, 45561881, 45561880,
                           45561879, 45561878, 45561877, 45561876, 45561875, 45561874, 45561873,
                           45561872, 45561871, 45561870, 45561868, 45561867, 45561866, 45561865,
                           45561864, 45561863, 45561862, 45561861, 45561860, 45561859, 45561858,
                           45561857, 45561856, 45561855, 45561854, 45561853, 45561852, 45561851,
                           45561850, 45561849, 45561848, 45561847, 45561846, 45561845, 45561844,
                           45561843, 45561842, 45561841, 45561840, 45561839, 45561838, 45561837,
                           45561829, 45561828, 45561827, 45561826, 45561825, 45561824, 45561823,
                           45561822, 45561821, 45561820, 45561819, 45561818, 45561817, 45561816,
                           45561815, 45561814, 45561813, 45561812, 45561811, 45561808, 45561807,
                           45561806, 45561805, 45561799, 45561798, 45561797, 45561796, 45561795,
                           45561794, 45561793, 45561792, 45561791, 45561790, 45561789, 45561788,
                           45561786, 45561785, 45561784, 45561783, 45561782, 45561781, 45561780,
                           45557048, 45557047, 45557046, 45557045, 45557044, 45557043, 45557042,
                           45557041, 45557040, 45557039, 45557038, 45557037, 45557036, 45557035,
                           45557034, 45557033, 45557032, 45557031, 45557030, 45557029, 45557028,
                           45557027, 45557026, 45557025, 45557024, 45557023, 45557022, 45557021,
                           45557020, 45557019, 45557011, 45557010, 45557009, 45557008, 45557007,
                           45557006, 45557005, 45557003, 45557002, 45557001, 45557000, 45556998,
                           45556997, 45556996, 45556995, 45556994, 45556989, 45556988, 45556987,
                           45556986, 45556985, 45556984, 45556983, 45556976, 45556975, 45556974,
                           45556973, 45556972, 45556971, 45556970, 45556969, 45556968, 45556967,
                           45556966, 45556965, 45556964, 45556963, 45556962, 45556961, 45556960,
                           45556959, 45556958, 45552317, 45552316, 45552315, 45552314, 45552313,
                           45552312, 45552311, 45552310, 45552309, 45552308, 45552307, 45552306,
                           45552305, 45552304, 45552303, 45552302, 45552301, 45552300, 45552299,
                           45552298, 45552297, 45552296, 45552295, 45552294, 45552293, 45552292,
                           45552291, 45552290, 45552280, 45552279, 45552278, 45552277, 45552276,
                           45552275, 45552274, 45552273, 45552272, 45552271, 45552270, 45552269,
                           45552268, 45552267, 45552266, 45552265, 45552264, 45552263, 45552262,
                           45552261, 45552260, 45552259, 45552258, 45552257, 45552256, 45552252,
                           45552251, 45552250, 45552249, 45552248, 45552247, 45552246, 45552245,
                           45552244, 45552243, 45552242, 45547561, 45547560, 45547559, 45547558,
                           45547557, 45547556, 45547555, 45547554, 45547553, 45547552, 45547551,
                           45547550, 45547549, 45547548, 45547547, 45547546, 45547545, 45547544,
                           45547543, 45547542, 45547541, 45547540, 45547539, 45547538, 45547537,
                           45547536, 45547535, 45547534, 45547533, 45547532, 45547531, 45547530,
                           45547521, 45547520, 45547519, 45547518, 45547517, 45547516, 45547515,
                           45547514, 45547513, 45547512, 45547511, 45547510, 45547509, 45547507,
                           45547506, 45547505, 45547504, 45547503, 45547491, 45547490, 45547489,
                           45547488, 45547487, 45547486, 45547485, 45547484, 45547483, 45547482,
                           45547481, 45547480, 45547479, 45547478, 45542670, 45542669, 45542668,
                           45542667, 45542666, 45542665, 45542664, 45542663, 45542662, 45542661,
                           45542660, 45542659, 45542658, 45542657, 45542656, 45542655, 45542654,
                           45542653, 45542652, 45542651, 45542650, 45542649, 45542648, 45542647,
                           45542646, 45542645, 45542644, 45542643, 45542642, 45542641, 45542640,
                           45542639, 45542638, 45542637, 45542636, 45542635, 45542634, 45542626,
                           45542625, 45542624, 45542623, 45542622, 45542621, 45542620, 45542619,
                           45542618, 45542617, 45542616, 45542615, 45542614, 45542613, 45542611,
                           45542610, 45542609, 45542599, 45542598, 45542597, 45542596, 45542595,
                           45542594, 45542593, 45542592, 45542591, 45542590, 45542589, 45542588,
                           45542587, 45542586, 45542585, 45542584, 45542583, 45542582, 45542581,
                           45542580, 45542579, 45537881, 45537880, 45537879, 45537878, 45537877,
                           45537876, 45537875, 45537874, 45537873, 45537872, 45537871, 45537870,
                           45537869, 45537868, 45537867, 45537866, 45537865, 45537864, 45537863,
                           45537862, 45537861, 45537860, 45537859, 45537858, 45537857, 45537856,
                           45537855, 45537854, 45537853, 45537852, 45537851, 45537850, 45537849,
                           45537848, 45537847, 45537846, 45537838, 45537837, 45537836, 45537835,
                           45537834, 45537833, 45537832, 45537831, 45537830, 45537829, 45537828,
                           45537827, 45537826, 45537825, 45537824, 45537823, 45537822, 45537821,
                           45537820, 45537818, 45537817, 45537816, 45537815, 45537814, 45537805,
                           45537804, 45537803, 45537802, 45537801, 45537800, 45537799, 45537798,
                           45537797, 45537796, 45537795, 45537793, 45537792, 45537791, 45537790,
                           45537789, 45537788, 45537787, 45537786, 45532965, 45532964, 45532963,
                           45532962, 45532961, 45532960, 45532959, 45532958, 45532957, 45532955,
                           45532954, 45532953, 45532952, 45532951, 45532950, 45532949, 45532948,
                           45532947, 45532946, 45532945, 45532944, 45532943, 45532942, 45532935,
                           45532934, 45532933, 45532932, 45532931, 45532930, 45532929, 45532928,
                           45532927, 45532926, 45532925, 45532924, 45532923, 45532922, 45532921,
                           45532920, 45532919, 45532918, 45532917, 45532916, 45532915, 45532914,
                           45532913, 45532912, 45532911, 45532902, 45532901, 45532900, 45532899,
                           45532898, 45532897, 45532896, 45532895, 45532894, 45532893, 45532892,
                           45532891, 44836875, 44836874, 44836873, 44836872, 44836871, 44836870,
                           44836869, 44836868, 44836867, 44836866, 44836865, 44836864, 44836863,
                           44836862, 44836861, 44836860, 44836859, 44836858, 44836857, 44836856,
                           44836855, 44836854, 44836853, 44836846, 44836845, 44836844, 44836843,
                           44836842, 44836841, 44836840, 44836839, 44836838, 44836837, 44836834,
                           44836833, 44836832, 44836831, 44836830, 44836829, 44836828, 44836827,
                           44836826, 44836825, 44836824, 44836823, 44836822, 44836821, 44836820,
                           44836819, 44836818, 44836817, 44835718, 44835717, 44835716, 44835715,
                           44835714, 44835713, 44835712, 44835711, 44835710, 44835709, 44835708,
                           44835707, 44835706, 44835705, 44835704, 44835703, 44835702, 44835701,
                           44835700, 44835699, 44835698, 44835697, 44835696, 44835695, 44835694,
                           44835693, 44835692, 44835691, 44835690, 44835689, 44835688, 44835687,
                           44835682, 44835681, 44835680, 44835679, 44835678, 44835677, 44835673,
                           44835672, 44835671, 44835670, 44835669, 44835668, 44835667, 44835666,
                           44835665, 44835664, 44835663, 44835662, 44835661, 44835660, 44834522,
                           44834521, 44834520, 44834519, 44834518, 44834517, 44834516, 44834515,
                           44834514, 44834513, 44834512, 44834511, 44834510, 44834509, 44834508,
                           44834507, 44834506, 44834505, 44834504, 44834500, 44834499, 44834498,
                           44834497, 44834496, 44834495, 44834494, 44834493, 44834492, 44834491,
                           44834490, 44834489, 44834488, 44834486, 44834485, 44834484, 44834483,
                           44834482, 44834481, 44834479, 44834478, 44834477, 44834476, 44834475,
                           44834474, 44833345, 44833344, 44833343, 44833342, 44833341, 44833340,
                           44833339, 44833338, 44833337, 44833336, 44833335, 44833334, 44833333,
                           44833332, 44833331, 44833330, 44833329, 44833328, 44833327, 44833326,
                           44833325, 44833324, 44833323, 44833322, 44833321, 44833320, 44833319,
                           44833318, 44833317, 44833316, 44833315, 44833314, 44833313, 44833312,
                           44833311, 44833306, 44833305, 44833304, 44833303, 44833302, 44833301,
                           44833300, 44833299, 44833294, 44833293, 44833292, 44833291, 44833290,
                           44833289, 44833288, 44833287, 44833286, 44833285, 44833284, 44833283,
                           44833282, 44833281, 44833280, 44832165, 44832164, 44832163, 44832162,
                           44832161, 44832160, 44832159, 44832158, 44832157, 44832156, 44832155,
                           44832154, 44832153, 44832152, 44832151, 44832150, 44832149, 44832148,
                           44832147, 44832146, 44832145, 44832144, 44832143, 44832142, 44832141,
                           44832140, 44832139, 44832138, 44832137, 44832134, 44832133, 44832132,
                           44832131, 44832130, 44832129, 44832128, 44832125, 44832124, 44832123,
                           44832122, 44832121, 44832120, 44832119, 44832118, 44832117, 44831019,
                           44831018, 44831017, 44831016, 44831015, 44831014, 44831013, 44831012,
                           44831011, 44831010, 44831009, 44831008, 44831007, 44831006, 44831005,
                           44831004, 44831003, 44831002, 44831001, 44831000, 44830999, 44830998,
                           44830997, 44830996, 44830995, 44830994, 44830993, 44830992, 44830991,
                           44830988, 44830987, 44830986, 44830985, 44830984, 44830983, 44830977,
                           44830976, 44830975, 44830974, 44830973, 44830972, 44830971, 44830970,
                           44830969, 44830968, 44830967, 44830966, 44829852, 44829851, 44829850,
                           44829849, 44829848, 44829847, 44829846, 44829845, 44829844, 44829843,
                           44829842, 44829841, 44829840, 44829839, 44829838, 44829837, 44829836,
                           44829835, 44829834, 44829833, 44829832, 44829831, 44829830, 44829829,
                           44829828, 44829827, 44829826, 44829825, 44829824, 44829820, 44829819,
                           44829818, 44829817, 44829816, 44829815, 44829814, 44829813, 44829812,
                           44829811, 44829810, 44829806, 44829805, 44829804, 44829803, 44829802,
                           44829801, 44829800, 44829798, 44829797, 44829796, 44829795, 44829794,
                           44829793, 44829792, 44829791, 44829790, 44829789, 44829788, 44829787,
                           44828781, 44828761, 44828760, 44828759, 44828758, 44828757, 44828756,
                           44828755, 44828754, 44828753, 44828752, 44828751, 44828750, 44828749,
                           44828748, 44828744, 44828743, 44828742, 44828741, 44828740, 44828736,
                           44828735, 44828734, 44828733, 44828732, 44828731, 44828730, 44828729,
                           44828728, 44828727, 44828726, 44828725, 44828724, 44827588, 44827587,
                           44827586, 44827585, 44827584, 44827583, 44827582, 44827581, 44827580,
                           44827579, 44827578, 44827577, 44827576, 44827575, 44827574, 44827573,
                           44827572, 44827571, 44827570, 44827569, 44827566, 44827565, 44827564,
                           44827563, 44827562, 44827561, 44827559, 44827558, 44827557, 44827556,
                           44827555, 44827554, 44827553, 44827552, 44827551, 44827550, 44827549,
                           44827548, 44827547, 44827546, 44827545, 44827544, 44827543, 44827542,
                           44826436, 44826435, 44826434, 44826433, 44826432, 44826431, 44826430,
                           44826429, 44826428, 44826427, 44826426, 44826425, 44826424, 44826423,
                           44826422, 44826421, 44826420, 44826419, 44826418, 44826417, 44826415,
                           44826414, 44826413, 44826412, 44826411, 44826410, 44826409, 44826408,
                           44826407, 44826406, 44826402, 44826401, 44826400, 44826399, 44826398,
                           44826397, 44826396, 44826395, 44826394, 44826393, 44826392, 44826391,
                           44826390, 44826389, 44826388, 44826387, 44826386, 44826385, 44826384,
                           44825236, 44825235, 44825234, 44825233, 44825232, 44825231, 44825230,
                           44825229, 44825228, 44825227, 44825226, 44825225, 44825224, 44825223,
                           44825222, 44825221, 44825220, 44825219, 44825218, 44825217, 44825216,
                           44825215, 44825214, 44825213, 44825212, 44825211, 44825210, 44825209,
                           44825208, 44825207, 44825206, 44825205, 44825204, 44825201, 44825200,
                           44825199, 44825198, 44825197, 44825196, 44825195, 44825194, 44825193,
                           44825192, 44825191, 44825190, 44825189, 44825188, 44824055, 44824054,
                           44824053, 44824052, 44824051, 44824050, 44824049, 44824048, 44824047,
                           44824046, 44824045, 44824044, 44824043, 44824042, 44824041, 44824040,
                           44824039, 44824038, 44824035, 44824034, 44824033, 44824032, 44824031,
                           44824030, 44824029, 44824026, 44824025, 44824024, 44824023, 44824022,
                           44824021, 44824020, 44822913, 44822912, 44822911, 44822910, 44822909,
                           44822908, 44822907, 44822906, 44822905, 44822904, 44822903, 44822902,
                           44822901, 44822900, 44822899, 44822898, 44822897, 44822896, 44822895,
                           44822894, 44822893, 44822892, 44822891, 44822890, 44822889, 44822888,
                           44822887, 44822886, 44822885, 44822880, 44822879, 44822878, 44822877,
                           44822876, 44822875, 44822874, 44822873, 44822872, 44822871, 44822870,
                           44822869, 44822868, 44822867, 44822866, 44822865, 44821763, 44821762,
                           44821761, 44821760, 44821759, 44821758, 44821757, 44821756, 44821755,
                           44821754, 44821753, 44821752, 44821751, 44821750, 44821749, 44821748,
                           44821747, 44821746, 44821745, 44821744, 44821743, 44821742, 44821741,
                           44821740, 44821736, 44821735, 44821734, 44821733, 44821732, 44821726,
                           44821725, 44821724, 44821723, 44821722, 44821721, 44820647, 44820646,
                           44820645, 44820644, 44820643, 44820642, 44820641, 44820640, 44820639,
                           44820638, 44820637, 44820636, 44820635, 44820634, 44820633, 44820632,
                           44820631, 44820630, 44820629, 44820628, 44820627, 44820626, 44820625,
                           44820624, 44820623, 44820622, 44820621, 44820620, 44820619, 44820618,
                           44820617, 44820616, 44820615, 44820614, 44820607, 44820606, 44820605,
                           44820604, 44820603, 44820602, 44820601, 44820600, 44820599, 44820598,
                           44820597, 44820596, 44820595, 44820594, 44819472, 44819471, 44819470,
                           44819469, 44819468, 44819467, 44819466, 44819465, 44819464, 44819463,
                           44819462, 44819461, 44819460, 44819459, 44819458, 44819457, 44819456,
                           44819455, 44819454, 44819453, 44819452, 44819451, 44819450, 44819449,
                           44819448, 44819447, 44819446, 44819445, 44819444, 44819441, 44819440,
                           44819439, 44819438, 44819437, 44819436, 44819435, 44819434, 44819428,
                           44819427, 44819426, 44819425, 44819424, 44819423, 44819422, 44819421,
                           44819420, 37200009, 37200008, 37200007, 37200006, 37200005, 37200004,
                           37200003, 37200002, 35206456, 35206455, 35206454, 35206453, 35206452,
                           35206451, 35206450, 35206449, 35206448, 35206447, 35206446, 35206445,
                           35206444, 35206443, 35206442, 35206441, 35206440, 35206439, 35206438,
                           35206437, 35206436, 35206435, 35206434, 35206433, 35206432, 35206431,
                           35206430, 35206429, 35206428, 35206427, 35206426, 35206425, 35206424,
                           35206423, 35206422, 35206421, 35206420, 35206419, 35206418, 35206417,
                           35206416, 35206415, 35206414, 35206413, 35206412, 35206411, 35206410,
                           35206409, 35206408, 35206407, 35206406, 35206405, 35206404, 35206403,
                           35206402, 35206401, 35206400, 35206399, 35206398, 35206397, 35206396,
                           35206395, 35206394, 35206393, 35206392, 35206391, 35206390, 35206389,
                           35206388, 35206387, 35206386, 35206385, 35206384, 35206383, 35206382,
                           35206381, 35206380, 35206379, 35206378, 35206377, 35206376, 35206375,
                           35206374, 35206373, 35206372, 35206371, 35206370, 35206369, 35206368,
                           35206367, 35206366, 35206365, 35206364, 35206363, 35206362, 35206361,
                           35206360, 35206359, 35206358, 35206357, 35206356, 35206355, 35206354,
                           35206353, 35206352, 35206351, 35206350, 35206349, 35206348, 35206347,
                           35206346, 35206345, 35206344, 35206343, 35206342, 35206341, 35206340,
                           35206339, 35206338, 35206337, 35206336, 35206335, 35206318, 35206317,
                           35206316, 35206315, 35206314, 35206313, 35206312, 35206311, 35206310,
                           35206309, 35206308, 35206307, 35206306, 35206305, 35206304, 35206303,
                           35206302, 35206301, 35206300, 35206299, 35206298, 35206297, 35206296,
                           35206295, 35206294, 35206293, 35206292, 35206291, 35206290, 35206289,
                           35206288, 35206287, 35206286, 35206285, 35206284, 35206283, 35206282,
                           35206281, 35206280, 35206279, 35206278, 35206277, 35206276, 35206275,
                           35206274, 35206273, 35206272, 35206271, 35206270, 35206269, 35206268,
                           35206267, 35206266, 35206260, 35206259, 35206258, 35206257, 35206256,
                           35206255, 35206254, 35206253, 35206252, 35206251, 35206250, 35206249,
                           35206248, 35206247, 35206246, 35206245, 35206244, 35206243, 35206242,
                           35206241, 35206240, 35206239, 35206238, 35206237, 35206236, 35206235,
                           35206234, 35206233, 35206232, 35206231, 35206230, 35206229, 35206228,
                           35206227, 35206226, 35206225, 35206224, 35206223, 35206222, 35206221,
                           35206220, 35206219, 35206218, 35206217, 35206216, 35206215, 35206214,
                           35206213, 35206212, 35206211, 35206210, 35206209, 35206208, 35206203,
                           35206202, 35206201, 35206200, 35206199, 35206198, 35206197, 35206196,
                           35206195, 35206194, 35206193, 35206192, 35206191, 35206190, 35206189,
                           35206188, 35206187, 35206186, 35206185, 35206184, 35206183, 35206182,
                           35206181, 35206180, 35206179, 35206178, 35206177, 35206176, 35206175,
                           35206174, 35206173, 35206172, 35206171, 35206170, 35206169, 35206168,
                           35206167, 35206166, 35206165, 35206164, 35206163, 35206162, 35206161,
                           35206160, 35206159, 35206158, 35206157, 35206156, 35206155, 35206154,
                           35206153, 35206152, 35206151, 35206150, 35206149, 35206148, 35206147,
                           35206146, 35206145, 35206144, 35206143, 35206142, 35206141, 35206140,
                           35206139, 35206138, 35206137, 35206136, 35206135, 35206134, 35206133,
                           35206132, 35206131, 35206130, 35206129, 35206128, 35206127, 35206126,
                           35206125, 35206124, 35206123, 35206122, 35206121, 35206120, 35206119,
                           35206118, 35206117, 35206116, 35206115, 35206114, 35206113, 35206112,
                           35206111, 35206110, 35206109, 35206108, 35206107, 35206106, 35206105,
                           35206104, 35206103, 35206102, 35206101, 35206100, 35206099, 35206098,
                           35206097, 35206096, 35206095, 35206094, 35206093, 35206092, 35206091,
                           35206090, 35206089, 35206088, 35206083, 35206082, 35206081, 35206080,
                           35206079, 35206078, 35206077, 35206076, 35206075, 35206074, 35206073,
                           35206072, 35206071, 35206070, 35206069, 35206068, 35206067, 35206066,
                           35206065, 35206064, 35206063, 35206062, 35206061, 35206060, 35206059,
                           35206058, 35206057, 35206056, 35206055, 35206054, 35206053, 35206052,
                           35206051, 35206050, 35206049, 35206048, 35206047, 1595486, 1595485,
                           1595484, 1595483, 1567715, 1567714, 1567713, 1567712, 1567711,
                           1567710, 1567709, 1567708, 1567707, 1567706, 1567705, 1567704,
                           1567703, 1567702, 1567701, 1567700, 1567699, 1567698, 1567697,
                           1567696, 1567695, 1567694, 1567693, 1567692, 1567691, 1567690,
                           1567689, 1567688, 1567687, 1567686, 1567685, 1567684, 1567683,
                           1567682, 1567681, 1567680, 1567679, 1567678, 1567677, 1567676,
                           1567675, 1567674, 1567672, 1567671, 1567670, 1567669, 1567668,
                           1567667, 1567666, 1567665, 1567664, 1567663, 1567662, 1567661,
                           1567660, 1567659, 1567658, 1567657, 1567656, 1567655, 1567654,
                           1567653, 1567652, 1567651, 1567650, 1567649, 1567648, 1567647,
                           1567646, 1567645, 1567644, 1567643, 1567642, 1567641, 1567640,
                           1567639, 1567638, 1567637, 1567636, 1567635, 1567634, 1567633,
                           1567617, 1567616, 1567615, 1567607, 1567606, 1567605, 1567604,
                           1567603, 1567602, 1567601, 1567600, 1567599, 1567598, 1567597,
                           1567596, 1567595, 1567594, 1567593, 1567592, 1567591, 1567590,
                           1567589, 1567588, 1567587, 1567586, 1567585, 1567584, 1567583,
                           1567582, 1567581, 1567580, 1567579, 1567578, 1567577, 1567576,
                           1567575, 1567574, 1567573, 1567572, 1567571, 1567570, 1567569,
                           1567568, 1567567, 1567566, 1567565, 1567564, 1567563, 1567562,
                           1567561, 1567560, 1567559, 1567558, 1567557, 1567556, 1567555,
                           1567554, 1567553, 1567552, 1567551, 1567550, 1567549, 1567548,
                           1567547, 1567546, 1567545, 1567544, 1567543, 1567542, 1567541,
                           1567540, 1567539, 1567538, 1567537, 1567536, 1567535, 1567534,
                           1567533, 1567532, 1567531, 1567530, 1567529, 1567528, 1567508,
                           1567507, 1567506, 1567505, 1567504, 1567503, 1567502, 1567501,
                           1567500, 1567499, 1567498, 1567497, 1567496, 1567495, 1567494,
                           1567493, 1567492, 1567491, 1567490, 1567489, 1567488, 1567487,
                           1567486, 1567485, 1567484, 1567483, 1567482, 1567481, 1567480,
                           1567479, 1567478, 1567477, 1567475, 1567474, 1567473, 1567472,
                           1567471, 1567470, 1567469, 1567468, 1567467, 1567466, 1567465,
                           1567464, 1567463, 1567462, 1567461, 1435817, 1435815, 1435814,
                           1435813, 1435812, 1435811, 1435810, 1435809, 1435807, 1435805,
                           1435804, 1435803, 1407040, 1407039, 1407038, 1407037, 1407036,
                           1407035, 1407034, 1407033, 1407032, 1407031, 1407030, 1407029,
                           1407028, 1407027, 1407026, 1407025, 1407024, 1407023, 1407022,
                           1407021, 1407020, 1407019, 1407018, 1407017, 1407016, 1407015,
                           1407014, 1407013, 1407012, 1407011, 1407010, 1407009, 1407008,
                           1407007, 1407006, 1407005, 1407004, 1407003, 1407002, 1407001,
                           1407000, 1406999, 1406998, 1406997, 1406996, 1406995, 1406994,
                           1406993, 1406992, 1406991, 1406990, 1406989, 1406988, 1406987,
                           1406986, 1406985, 1406984, 1406983, 1406982, 1406981, 1406980,
                           1406979, 1406978, 1406977, 1406976, 1406975, 1406974, 1406973,
                           1406972, 1406971, 1406970, 1406969, 1406968, 1406967, 1406966,
                           1406965, 1406964, 1406963, 1406962, 1406961, 1406960, 1406959,
                           1406958, 1406957, 1406956, 1406955, 1406954, 1406953, 1406952,
                           1406951, 1406950, 1406949, 1406948, 1406947, 1406946, 1406945,
                           1406944, 1406943, 1406942, 1406941, 1406940, 1406939, 1406938,
                           1406937, 1406936, 1406935, 1406934, 1406933, 1406932, 1406931,
                           1406930, 1406929, 1406928, 1406927, 1406926, 1406925, 1406924,
                           1406923, 1406922, 1406921, 1406920, 1406919, 1406918, 1406917,
                           1406916, 1406915, 1406914, 1406913, 1406912, 1406911, 1406910,
                           1406909, 1406908, 1406907, 1406906, 1406905, 1406904, 1406903,
                           1406902, 1406901, 1406900, 1406899, 1406898, 1406897, 1406896,
                           1406895, 1406894, 1406893, 1406892, 1406891, 1406890, 1406889,
                           1406888, 1406887, 1406886, 1406885, 1406884, 1406883, 1406882,
                           1406881, 1406880, 1406879, 1406878, 1406877, 1406876, 1406875,
                           1406874, 1406873, 1406872, 1406871, 1406870, 1406868, 1406867,
                           1406866, 1406865, 1406864, 1406863, 1406862, 1406861, 1406860,
                           1406859, 1406858, 1406857, 1406856, 1406855, 1406854, 1406853,
                           1406852, 1406851, 1406850, 1406849, 1406848, 1406847, 1406846,
                           1406845, 1406844, 1406843, 1406842, 1406841, 1406840, 1406839,
                           1406838, 1406837, 1406836, 1406835, 1406834, 1406833, 1406832,
                           1406831, 1406830, 1406829, 1406828, 1406827, 1406826, 1406825,
                           1406824, 1406823, 1406822, 1406821, 1406820, 1406819, 1406818,
                           1406817, 1406816, 1406815, 1406814, 1406813, 1406812, 1406811,
                           1406810, 1406809, 1406808, 1406807, 1406806, 1406805, 1406804,
                           1406803, 1406802, 1406801, 1406800, 1406799, 1406798, 1406797,
                           1406796, 1406795, 1406794, 1406792, 1406791, 1406790, 1406789,
                           1406788, 1406787, 1406786, 1406785, 1406784, 1406783, 1406782,
                           1406781, 1406780, 1406779, 1406778, 1406777, 1406776, 1406775,
                           1406774, 1406773, 1406772, 1406771, 1406770, 1406769, 1406768,
                           1406767, 1406766, 1406765, 1406764, 1406763, 1406762, 1406761,
                           1406760, 1406759, 1406758, 1406757, 1406756, 1406755, 1406754,
                           1406753, 1406752, 1406751, 1406750, 1406749, 1406748, 1406747,
                           1406746, 1406745, 1406744, 1406743, 1406742, 1406741, 1406740,
                           1406739, 1406738, 1406737, 1406540, 1406539, 1406538, 1406537,
                           1406536, 1406535, 1406534, 1406533, 1406532, 1406531, 1406530,
                           1406529, 1406528, 1406527, 1406526, 1406525, 1406524, 1406523,
                           1406522, 1406521, 1406520, 1406519, 1406518, 1406517, 1406516,
                           1406515, 1406514, 1406513, 1406512, 1406511, 1406510, 1406509,
                           1406508, 1406507, 1406506, 1406505, 1406504, 1406503, 1406502,
                           1406501, 1406500, 1406499, 1406498, 1406497, 1406496, 1406495,
                           1406494, 1406493, 1406492, 1406491, 1406490, 1406489, 1406488,
                           1406487, 1406486, 1406485, 1406484, 1406483, 1406482, 1406481,
                           1406480, 1406479, 1406478, 1406477, 1406476, 1406475, 1406474,
                           1406473, 1406472, 1406471, 1406470, 1406469, 1406468, 1406467,
                           1406466, 1406465, 1406464, 1406463, 1406462, 1406461, 1406460,
                           1406459, 1406458, 1406457, 1406456, 1406455, 1406454, 1406453,
                           1406452, 1406451, 1406450, 1406449, 1406448, 1406447, 1406446,
                           1406445, 1406444, 1406443, 1406442, 1406441, 1406440, 1406439,
                           1406438, 1406437, 1406435, 1406434, 1406433, 1406432, 1406431,
                           1406430, 1406429, 1406428, 1406427, 1406426, 1406425, 1406424,
                           1406423, 1406422, 1406421, 1406420, 1406419, 1406418, 1406417,
                           1406416, 1406415, 1406414, 1406413, 1406412, 1406411, 1406410,
                           1406409, 1406408, 1406407, 1406406, 1406405, 1406404, 1406403,
                           1406402, 1406401, 1406400, 1406399, 1406398, 1406397, 1406396,
                           1406395, 1406394, 1406393, 1406392, 1406391, 1406390, 1406389,
                           1406388, 1406387, 1406386, 1406385, 1406384, 1406383, 1406382,
                           1406381, 1406380, 1406379, 1406378, 1406377, 1406376, 1406375,
                           1406374, 1406373, 1406372, 1406371, 1406370, 1406369, 1406368,
                           1406367, 1406366, 1406365, 1406364, 1406363, 1406362, 1406361,
                           1406360, 1406359, 1406358, 1406357, 1406356, 1406355, 1406354,
                           1406353, 1406352, 1406351, 1406350, 1406349, 1406348, 1406347,
                           1406346, 1406345, 1406344, 1406343, 1406342, 1406341, 1406340,
                           1406339, 1406338, 1406337, 1406336, 1406335, 1406334, 1406333,
                           1406332, 1406331, 1406330, 1406329, 1406328, 1406327, 1406326,
                           1406325, 1406324, 1406323, 1406322, 1406321, 1406320, 1406319,
                           1406318, 1406317, 1406316, 1406315, 1406314, 1406313, 1406312,
                           1406311, 1406310, 1406309, 1406308, 1406307, 1406306, 1406305,
                           1406304, 1406303, 1406302, 1406301, 1406300, 1406299, 1406298,
                           1406297, 1406296, 1406295, 1406294, 1406293, 1406292, 1406291,
                           1406290, 1406289, 1406276, 1406275, 1406274, 1406273, 1406272,
                           1406271, 1406270, 1406269, 1406268, 1406267, 1406266, 1406265,
                           1406264, 1406263, 1406262, 1406261, 1406260, 1406259, 1406258,
                           1406257, 1406256, 1406255, 1406254, 1406253, 1406252, 1406251,
                           1406250, 1406249, 1406248, 1406247, 1406246, 1406245, 1406244,
                           1406243, 1406242, 1406241, 1406240, 1406239, 1406238, 1406237,
                           1406236, 1406235, 1406234, 1406233, 1406232, 1406231, 1406230,
                           1406229, 1406228, 1406227, 1406226, 1406225, 1406224, 1406223,
                           1406222, 1406221, 1406220, 1406219, 1406218, 1406217, 1406216,
                           1406215, 1406214, 1406213, 1406212, 1406211, 1406210, 1406209,
                           1406208, 1406207, 1406206, 1406205, 1406204, 1406203, 1406202,
                           1406201, 1406200, 1406199, 1406198, 1406197, 1406196, 1406195,
                           1406194, 1406193, 1406192, 1406191, 1406190, 1406189, 1406188,
                           1406187, 1406186, 1406185, 1406184, 1406183, 1406182, 1406181,
                           1406180, 1406179, 1406178, 1406177, 1406176, 1406175, 1406174,
                           1406173, 1406172, 1406171, 1406170, 1406169, 1406168, 1406167,
                           1406166, 1406165, 1406164, 1406163, 1406162, 1406161, 1406160,
                           1406159, 1406158, 1406157, 1406156, 1406155, 1406154, 1406153,
                           1406152, 1406151, 1406150, 1406149, 1406148, 1406147, 1406146,
                           1406145, 1406144, 1406143, 1406142, 1406141, 1406140, 1406139,
                           1406138, 1406137, 1406136, 1406135, 1406134, 1406133, 1406132,
                           1406131, 1406130, 1406129, 1406128, 1406127, 1406126, 1406125,
                           1406124, 1406123, 1406122, 1406121, 1406120, 1406119, 1406118,
                           1406117, 1406116, 1406115, 1406114, 1406113, 1406112, 1406111,
                           1406110, 1406109, 1406108, 1406107, 1406106, 1406105, 1406104,
                           1406103, 1406102, 1406101, 1406100, 1406099, 1406098, 1406097,
                           1406096, 1406095, 1406094, 1406093, 1406092, 1406091, 1406090,
                           1406089, 1406088, 1406087, 1406086, 1406085, 1406084, 1406083,
                           1406082, 1406081, 1406080, 1406079, 1406078, 1406077, 1406076,
                           1406075, 1406074, 1406073, 1406072, 1406071, 1406070, 1406069,
                           1406068, 1406067, 1406066, 1406065, 1406011, 1406010, 1406009,
                           1406008, 1406007, 1406006, 1406005, 1406004, 1406003, 1406002,
                           1406001, 1406000, 1405999, 1405998, 1405997, 1405996, 1405995,
                           1405994, 1405993, 1405992, 1405991, 1405990, 1405989, 1405988,
                           1405987, 1405986, 1405985, 1405984, 1405983, 1405982, 1405981,
                           1405980, 1405979, 1405978, 1405977, 1405976, 1405975, 1405974,
                           1405973, 1405972, 1405971, 1405970, 1405969, 1405968, 1405967,
                           1405966, 1405965, 1405964, 1405963, 1405962, 1405961, 1405960,
                           1405959, 1405958, 1405957, 1405956, 1405955, 1405954, 1405953,
                           1405952, 1405951, 1405950, 1405949, 1405948, 1405947, 1405946,
                           1405945, 1405944, 1405943, 1405942, 1405941, 1405940, 1405939,
                           1405938, 1405937, 1405936, 1405935, 1405934, 1405933, 1405931,
                           1405930, 1405929, 1405928, 1405927, 1405926, 1405925, 1405924,
                           1405923, 1405922, 1405921, 1405920, 1405919, 1405918, 1405917,
                           1405916, 1405915, 1405914, 1405913, 1405912, 1405911, 1405910,
                           1405909, 1405908, 1405907, 1405906, 1405905, 1405904, 1405903,
                           1405902, 1405901, 1405900, 1405899, 1405898, 1405897, 1405896,
                           1405895, 1405894, 1405893, 1405892, 1405891, 1405890, 1405889,
                           1405888, 1405887, 1405886, 1405885, 1405884, 1405883, 1405882,
                           1405881, 1405880, 1405879, 1405878, 1405877, 1405876, 1405875,
                           1405874, 1405873, 1405872, 1405871, 1405870, 1405869, 1405868,
                           1405867, 1405866, 1405865, 1405864, 1405863, 1405862, 1405861,
                           1405860, 1405859, 1405858, 1405857, 1405856, 1405855, 1405854,
                           1405853, 1405852, 1405851, 1405850, 1405849, 1405848, 1405847,
                           1405846, 1405845, 1405844, 1405843, 1405842, 1405841, 1405840,
                           1405839, 1405838, 1405837, 1405836, 1405835, 1405834, 1405833,
                           1405832, 1405831, 1405830, 1405829, 1405828, 1405827, 1405826,
                           1405825, 1405824, 1405823, 1405822, 1405821, 1405820, 1405819,
                           1405818, 1405817, 1405816, 1405815, 1405814, 1405813, 1405812,
                           1405811, 1405810, 1405809, 1405808, 1405807, 1405806, 1405805,
                           1405804, 1405803, 1405802, 1405801, 1405800, 1405799, 1405798,
                           1405797, 1405796, 1405795, 1405794, 1405793, 1405792, 1405791,
                           1405790, 1405789, 1405788, 1405787, 1405786, 1405785, 1405784,
                           1405783, 1405782, 1405781, 1405780, 1405779, 1405778, 1405777,
                           1405776, 1405775, 1405774, 1405773, 1405772, 1405771, 1405770,
                           1405769, 1405768, 1405767, 1405766, 1405765, 1405764, 1405763,
                           1405762, 1405761, 1405760, 1405759, 1405758, 1405757, 1405756,
                           1405755, 1405754, 1405752, 1405751, 1405750, 1405749, 1405748,
                           1405747, 1405746, 1405745, 1405744, 1405743, 1405742, 1405741,
                           1405740, 1405739, 1405738, 1405737, 1405736, 1405735, 1405734,
                           1405733, 1405732, 1405731, 1405730, 1405729, 1405728, 1405727,
                           1405726, 1405725, 1405724, 1405723, 1405722, 1405721, 1405720,
                           1405719, 1405718, 1405717, 1405716, 1405715, 1405714, 1405713,
                           1405712, 1405711, 1405710, 1405709, 1405708, 1405707, 1405706,
                           1405705, 1405704, 1405703, 1405702, 1405701, 1405700, 1405699,
                           1405698, 1405697, 1405696, 1405695, 1405694, 1405693, 1405692,
                           1405691, 1405690, 1405689, 1405688, 1405687, 1405686, 1405685,
                           1405684, 1405683, 1405682, 1405681, 1405680, 1405679, 1405678,
                           1405676, 1405675, 1405674, 1405673, 1405672, 1405671, 1405670,
                           1405669, 1405668, 1405667, 1405666, 1405665, 1405664, 1405663,
                           1405662, 1405661, 1405660, 1405659, 1405658, 1405657, 1405656,
                           1405655, 1405654, 1405653, 1405652, 1405651, 1405650, 1405649,
                           1405648, 1405647, 1405646, 1405645, 1405644, 1405643, 1405642,
                           1405641, 1405640, 1405639, 1405638, 1405637, 1405636, 1405635,
                           1405634, 1405633, 1405632, 1405631, 1405630, 1405629, 1405628,
                           1405627, 1405626, 1405625, 1405624, 1405623, 1405622, 1405621,
                           1405620, 1405619, 1405618, 1405617, 1405616, 1405615, 1405614,
                           1405613, 1405612, 1405611, 1405610, 1405609, 1405608, 1405607,
                           1405606, 1405605, 1405604, 1405603, 1405602, 1405601, 1405600,
                           1405599, 1405598, 1405597, 1405596, 1405595, 1405594, 1405593,
                           1405592, 1405591, 1405590, 1405589, 1405588, 1405587, 1405586,
                           1405585, 1405584, 1405583, 1405582, 1405581, 1405580, 1405579,
                           1405578, 1405577, 1405576, 1405575, 1405574, 1405573, 1405572,
                           1405571, 1405570, 1405569, 1405568, 1405567, 1405566, 1405565,
                           1405564, 1405553, 1405552, 1405551, 1405550, 1405549, 1405548,
                           1405547, 1405546, 1405545, 1405544, 1405543, 1405542, 1405541,
                           1405540, 1405539, 1405538, 1405537, 1405536, 1405535, 1405534,
                           1405533, 1405532, 1405531, 1405530, 1405529, 1405528, 1405527,
                           1405526, 1405525, 1405524, 1405523, 1405522, 1405521, 1405520,
                           1405519, 1405518, 1405517, 1405516, 1405515, 1405514, 1405513,
                           1405512, 1405511, 1405510, 1405509, 1405508, 1405507, 1405506,
                           1405505, 1405504, 1405503, 1405502, 1405501, 1405500, 1405499,
                           1405498, 1405497, 1405496, 1405495, 1405494, 1405493, 1405492,
                           1405491, 1405490, 1405489, 1405488, 1405487, 1405486, 1405485,
                           1405484, 1405483, 1405482, 1405481, 1405480, 1405479, 1405478,
                           1405477, 1405476, 1405475, 1405474, 1405473, 1405472, 1405471,
                           1405470, 1405469, 1405468, 1405467, 1405466, 1405465, 1405464,
                           1405463, 1405462, 1405461, 1405460, 1405459, 1405458, 1405457,
                           1405456, 1405455, 1405454, 1405453, 1405452, 1405451, 1405450,
                           1405449, 1405448, 1405447, 1405446, 1405445, 1405444, 1405443,
                           1326487, 1326486, 1326485, 1326484, 920127, 920126, 920125, 920124,
                           920123),
                         c(45601186, 45591608, 45591607, 45591533, 45586730, 45586729,
                           45581835, 45581834, 45576999, 45572226, 45572150, 45562429, 45557677,
                           45557675, 45557672, 45557671, 45552948, 45552947, 45543339, 45538463,
                           45533613, 44837179, 44834823, 44832407, 44832406, 44828998, 44825529,
                           44825455, 44824273, 44822040, 35208366, 35208365, 35208364, 35207901,
                           1569679, 1569678, 1569674, 1569672, 1569401, 1417635, 1417634,
                           1417633, 1417632, 1417631, 1417630, 1417629, 1417628, 1417627,
                           1417538, 1417537, 1417536, 1417535, 1417534, 1417533, 1417532,
                           1417531, 1417504, 1417503, 1417502, 1417501, 1417500, 1417499,
                           1417491, 1417490, 1417489, 1417488, 1417487, 1415145, 1415006,
                           1415005, 1415004, 1414992, 1414991, 1414990, 1414989, 1414988),
                         c(45755341, 45605289, 45605288, 45600529, 45600528, 45600527,
                           45600526, 45595689, 45595688, 45595687, 45595686, 45595685, 45590926,
                           45590925, 45586028, 45586027, 45576343, 45576342, 45576341, 45576340,
                           45576339, 45576338, 45571541, 45571540, 45571539, 45571538, 45566620,
                           45561836, 45561834, 45561833, 45561832, 45561831, 45561830, 45557018,
                           45557017, 45557016, 45557015, 45557014, 45557013, 45557012, 45552286,
                           45552285, 45552284, 45552283, 45552282, 45552281, 45547529, 45547524,
                           45547523, 45547522, 45542630, 45542629, 45542628, 45542627, 45537843,
                           45537842, 45537841, 45537840, 45537839, 45532939, 45532938, 45532937,
                           45532936, 44836852, 44836851, 44836850, 44836849, 44836848, 44836847,
                           44835686, 44835685, 44835684, 44835683, 44834503, 44834502, 44834501,
                           44833310, 44833309, 44833308, 44833307, 44832136, 44832135, 44830990,
                           44830989, 44829822, 44829821, 44828747, 44828746, 44828745, 44827568,
                           44827567, 44826416, 44824037, 44824036, 44821739, 44821738, 44821737,
                           44819443, 44819442, 35206334, 35206333, 35206332, 35206331, 35206330,
                           35206329, 35206328, 35206327, 35206326, 35206325, 35206324, 35206323,
                           35206322, 35206321, 35206320, 35206319, 1567632, 1567631, 1567630,
                           1567629, 1567628, 1567627, 1567626, 1567625, 1567624, 1567623,
                           1567622, 1567621, 1567620, 1567619, 1567618, 1435816, 1406736,
                           1406735, 1406734, 1406733, 1406732, 1406731, 1406730, 1406729,
                           1406728, 1406727, 1406726, 1406725, 1406724, 1406723, 1406722,
                           1406721, 1406720, 1406719, 1406718, 1406717, 1406716, 1406715,
                           1406714, 1406713, 1406712, 1406711, 1406710, 1406709, 1406708,
                           1406707, 1406706, 1406705, 1406704, 1406703, 1406702, 1406701,
                           1406700, 1406699, 1406698, 1406697, 1406696, 1406695, 1406694,
                           1406693, 1406692, 1406691, 1406690, 1406689, 1406688, 1406687,
                           1406686, 1406685, 1406684, 1406683, 1406682, 1406681, 1406680,
                           1406679, 1406678, 1406677, 1406676, 1406675, 1406674, 1406673,
                           1406672, 1406671, 1406670, 1406669, 1406668, 1406667, 1406666,
                           1406665, 1406664, 1406663, 1406662, 1406661, 1406660, 1406659,
                           1406658, 1406657, 1406656, 1406655, 1406654, 1406653, 1406652,
                           1406651, 1406650, 1406649, 1406648, 1406647, 1406646, 1406645,
                           1406644, 1406643, 1406642, 1406641, 1406640, 1406639, 1406638,
                           1406637, 1406636, 1406635, 1406634, 1406633, 1406632, 1406631,
                           1406630, 1406629, 1406628, 1406627, 1406626, 1406625, 1406624,
                           1406623, 1406622, 1406621, 1406620, 1406619, 1406618, 1406617,
                           1406616, 1406615, 1406614, 1406612, 1406611, 1406610, 1406609,
                           1406608, 1406607, 1406606, 1406605, 1406604, 1406603, 1406602,
                           1406601, 1406600, 1406599, 1406598, 1406597, 1406596, 1406595,
                           1406594, 1406593, 1406592, 1406591, 1406590, 1406589, 1406588,
                           1406587, 1406586, 1406585, 1406584, 1406583, 1406582, 1406581,
                           1406580, 1406579, 1406578, 1406577, 1406576, 1406575, 1406574,
                           1406573, 1406572, 1406571, 1406570, 1406569, 1406568, 1406567,
                           1406566, 1406565, 1406564, 1406563, 1406562, 1406561, 1406560,
                           1406559, 1406558, 1406557, 1406556, 1406555, 1406554, 1406553,
                           1406552, 1406551, 1406550, 1406549, 1406548, 1406547, 1406546,
                           1406545, 1406544, 1406543, 1406542, 1406541, 920115),
                         c(45755325, 45755324, 45600449, 45595610, 45590847, 45585950,
                           45581152, 45571463, 45571462, 45571461, 45571460, 45571459, 45571458,
                           45566541, 45561748, 45561747, 45556932, 45556931, 45556930, 45552213,
                           45547443, 45542557, 45542556, 45537755, 45532867, 44829737, 35205776,
                           1435794, 1404640, 1404639, 1404638, 1404626, 1404625, 1404624,
                           1404623, 1404622, 1404621, 1404620, 1404619, 1404618, 1404617,
                           1404616, 1404615, 1404614, 1404613, 1404612, 1404611, 1404610,
                           1404609, 1404608, 1404607, 1404606, 1404605, 1404604, 1404603,
                           1404602, 1404601, 1404600, 1404599, 1404598, 1404597, 1404596,
                           1404595, 1404594, 1404593, 1404592, 1404591, 1404590, 1404589,
                           1404588, 1404587, 1404586, 1404585, 1404584, 1404583, 1404582,
                           1404581, 1404580, 1404579, 1404578, 1404577, 1404576, 1404575,
                           1404574, 1404573, 1404572, 1404571)
                         )

# Specify parameters for CCI component columns
attributeNames <- c("'Myocardial Infraction'",
                    "'Congestive Heart Failure'",
                    "'Peripheral Vascular Disease'",
                    "'Cerebrovascular Disease'",
                    "'Dementia'",
                    "'Chronic Pulmonary Disease'",
                    "'Rheumatic Disease'",
                    "'Peptic Ulcer Disease'",
                    "'Mild Liver Disease'",
                    "'Diabetes Without Chronic Complication'",
                    "'Diabetes With Chronic Complication'",
                    "'Hemiplegia or Paraplegia'",
                    "'Renal Disease'",
                    "'Malignancy, Except Skin Neoplasms'",
                    "'Moderate or Severe Liver Disease'",
                    "'Metastatic Solid Tumor'",
                    "'AIDS HIV'")
attributeDefinitionIds <- c(1:length(sourceConceptIds))*1000000
lookbackPeriod <- 365


# ==================================================================================================================
# Create attribute definition tables (for CCI components)
# ==================================================================================================================

for(i in 1:num_cohorts){

  if(file.exists(paste0(wd, "/cohort_", i, "/cci_created.csv"))){
    print(paste("Attribute file for cohort", i, "exists - moving to next cohort"))
    next
  } else{
    print(paste("Creating attribute file for cohort", i))
  }

  # Create custom variable tables
  sql <- readSql("CreateCustomVariableTables.sql")
  sql <- render(sql,
                cohort_database_schema = cohortDatabaseSchema,
                cohort_attribute_table = paste0(cohortAttributeTable, "_", i),
                attribute_definition_table = paste0(attributeDefinitionTable, "_", i))
  sql <- translate(sql, targetDialect = connectionDetails$dbms)
  executeSql(connection, sql)
  rm(sql)

  # Populate custom variable tables
  for(j in 1:length(sourceConceptIds)){
    sql <- readSql("CreateCustomVariables.sql")
    sql <- render(sql,
                  cdm_database_schema = cdmDatabaseSchema,
                  cohort_database_schema = cohortDatabaseSchema,
                  cohort_table = paste0(cohortTable, "_", i),
                  cohort_attribute_table = paste0(cohortAttributeTable, "_", i),
                  attribute_definition_table = paste0(attributeDefinitionTable, "_", i),
                  attribute_definition_id = attributeDefinitionIds[j],
                  attribute_name = attributeNames[j],
                  source_concept_ids = sourceConceptIds[[j]],
                  lookback_period = lookbackPeriod,
                  cohort_definition_ids = c(1,2))
    sql <- translate(sql, targetDialect = connectionDetails$dbms)
    executeSql(connection, sql)
    rm(sql)
  }

  file.create(paste0(wd, "/cohort_", i, "/cci_created.csv"))
}
rm(sourceConceptIds, attributeNames, attributeDefinitionIds, lookbackPeriod)


# ==================================================================================================================
# Explore attribute tables
# ==================================================================================================================

# # Test attribute tables appropriately generated
# for(i in 1:num_cohorts){
#   sql <- paste("SELECT cohort_definition_id, COUNT(*) AS count",
#                "FROM @cohortDatabaseSchema.@cohortTable",
#                "GROUP BY cohort_definition_id")
#   sql <- render(sql,
#                 cohortDatabaseSchema = cohortDatabaseSchema,
#                 cohortTable = paste0(cohortAttributeTable, "_", i))
#   sql <- translate(sql, targetDialect = connectionDetails$dbms)
#   print(querySql(connection, sql))
#   rm(sql)
# }
# 
# for(i in 1:num_cohorts){
#   sql <- paste("SELECT TOP 10 *",
#                "FROM @cohortDatabaseSchema.@cohortTable")
#   sql <- render(sql,
#                 cohortDatabaseSchema = cohortDatabaseSchema,
#                 cohortTable = paste0(cohortAttributeTable, "_", i))
#   sql <- translate(sql, targetDialect = connectionDetails$dbms)
#   print(querySql(connection, sql))
#   rm(sql)
# }
# 
# for(i in 1:num_cohorts){
#   sql <- paste("SELECT TOP 10 *",
#                "FROM @cohortDatabaseSchema.@cohortTable")
#   sql <- render(sql,
#                 cohortDatabaseSchema = cohortDatabaseSchema,
#                 cohortTable = paste0(attributeDefinitionTable, "_", i))
#   sql <- translate(sql, targetDialect = connectionDetails$dbms)
#   print(querySql(connection, sql))
#   rm(sql)
# }


# ==================================================================================================================
# Feature Extraction - with custom variables
# ==================================================================================================================

# Create data frame for PSM / CM
for(i in 1:num_cohorts){
  
  if(file.exists(paste0(wd, "/cohort_", i, "/df.csv"))){
    print(paste("Data frame already created for cohort", i, "- moving to next cohort"))
    next
  } else{
    print(paste("Creating data frame for cohort", i))
  }
  
  # Set parameters
  covSet <- createCohortAttrCovariateSettings(attrDatabaseSchema = cohortDatabaseSchema,
                                              cohortAttrTable = paste0(cohortAttributeTable, "_", i),
                                              attrDefinitionTable = paste0(attributeDefinitionTable, "_", i),
                                              includeAttrIds = c(),
                                              isBinary = TRUE,
                                              missingMeansZero = FALSE)
  covariateSettings <- createCovariateSettings(useDemographicsGender = TRUE,
                                               useDemographicsAgeGroup = TRUE,
                                               useDemographicsRace = TRUE,
                                               useDemographicsEthnicity = TRUE,
                                               useDemographicsIndexYear = TRUE,
                                               useHfrs = TRUE)
  covariateSettingsList <- list(covariateSettings, covSet)
  
  # Get covariate data
  covariates <- getDbCovariateData(connectionDetails = connectionDetails,
                                   cdmDatabaseSchema = cdmDatabaseSchema,
                                   cohortDatabaseSchema = cohortDatabaseSchema,
                                   cohortTable = paste0(cohortTable, "_", i),
                                   cohortId = -1,
                                   covariateSettings = covariateSettingsList)

  
  # Load cmData object
  cmData <- loadCohortMethodData(paste0(wd, "/cohort_", i, "/cmData"))
  cmData$cohorts$rowId <- cmData$cohorts$subjectId
  
  # Create data frame; merge cmData and covariates objects
  df <- covariates$covariates[, ]
  df <- dcast(df, rowId ~ covariateId, value.var = "covariateValue")
  df <- merge(df, cmData$cohorts[, c("rowId", "treatment")], by="rowId")
  df[is.na(df)] <- 0
  df <- df[order(df$treatment, decreasing = TRUE), ]
  
  # Update column names
  temp <- covariates$covariateRef[covariates$covariateRef$covariateId[] %in% colnames(df), ]
  row.names(temp) <- temp$covariateId
  temp <- temp[colnames(df)[colnames(df) %in% c("rowId", "treatment") == FALSE], ]
  colnames(df)[colnames(df) %in% c("rowId", "treatment") == FALSE] <- as.character(temp$covariateName)
  
  # Save file
  write.csv(df, paste0(wd, "/cohort_", i, "/df.csv"), row.names = FALSE)
  
  rm(cmData, df, covSet, covariateSettings, covariateSettingsList, covariates)
}


# ==================================================================================================================
# Explore data frames
# ==================================================================================================================

# for(i in 1:num_cohorts){
#   df <- read.csv(paste0(wd, "/cohort_", i, "/df.csv"))
# 
#   print(nrow(df))
#   print(ncol(df))
# 
#   rm(df)
# }


# ==================================================================================================================
# Perform PSM
# ==================================================================================================================

for(i in 1:num_cohorts){
  
  if(file.exists(paste0(wd, "/cohort_", i, "/psm.rds"))){
    print(paste("Propensity score matching already performed for cohort", i, "- moving to next cohort"))
    next
  } else{
    print(paste("Performing propensity score matching for cohort", i))
  }
  
  # Prepare data
  df <- read.csv(paste0(wd, "/cohort_", i, "/df.csv"))
  match_vars <- colnames(df)[colnames(df) %in% c("rowId", "treatment", "Hospital.Frailty.Risk.Score..hfrs.") == FALSE]
  f <- as.formula(paste0("treatment ~ ", paste(match_vars, collapse = " + ")))
  
  # Set seed
  set.seed(i)
  
  # Perform match
  m_out <- matchit(f,
                   data = df,
                   method="nearest",
                   ratio=1,
                   caliper=0.15)
  
  # Save results
  saveRDS(m_out, paste0(wd, "/cohort_", i, "/psm.rds"))
  
  rm(m_out, temp, df, f, match_vars)
}


# ==================================================================================================================
# Populate SQL tables with propensity score-matched populations
# ==================================================================================================================

# Set parameters
datafile <- c("psm.rds")
cohort_id <- list(c(19, 20))

# Populate cohort tables with propensity score-matched tables
for(i in 1:num_cohorts){
  
  if(file.exists(paste0(wd, "/cohort_", i, "/psm_populated.csv"))){
    print(paste("Propensity score-matched sample populated in cohort table for cohort", i, "exists - moving to next cohort"))
    next
  } else{
    print(paste("Populating propensity score-matched sample in cohort table for cohort", i))
  }
  
  # Load data
  cmData <- loadCohortMethodData(paste(wd, "/cohort_", i, "/cmData", sep = ""))
  df <- read.csv(paste(wd, "/cohort_", i, "/df.csv", sep = ""))
  
  # Obtain list of cohortIds currently within cohort data frame
  sql <- paste("SELECT cohort_definition_id",
               "FROM @cohortDatabaseSchema.@cohortTable",
               "GROUP BY cohort_definition_id")
  sql <- render(sql,
                cohortDatabaseSchema = cohortDatabaseSchema,
                cohortTable = paste0(cohortTable, "_", i))
  sql <- translate(sql, targetDialect = connectionDetails$dbms)
  cohortIds <- querySql(connection, sql)
  
  
  for(j in 1:length(datafile)){
    
    if(sum(cohort_id[[j]] %in% cohortIds$COHORT_DEFINITION_ID) == 2){
      print(paste("Datafile", datafile[j], "already uploaded"))
      next
    } else{
      print(paste("Uploading datafile", datafile[j]))
    }
    
    # Set parameters
    t_cohort_id <- cohort_id[[j]][1]
    c_cohort_id <- cohort_id[[j]][2]
    
    # Get matched rowIds
    out_1 <- readRDS(paste0(wd, "/cohort_", i, "/", datafile[j]))
    temp <- df[out_1$weights == 1, ]
    t_rowId <- temp$rowId[temp$treatment == 1]
    c_rowId <- temp$rowId[temp$treatment == 0]
    rm(temp)
    
    # Skip when no matched patients
    if(length(t_rowId) == 0 | length(c_rowId) == 0){
      next
    }
    
    # Determine subjectIds
    t_subjectIds <- unique(cmData$cohorts$subjectId[cmData$cohorts$subjectId %in% t_rowId])
    c_subjectIds <- unique(cmData$cohorts$subjectId[cmData$cohorts$subjectId %in% c_rowId])
    
    # Verify lengths of vectors are matched
    if(length(t_subjectIds) != length(c_subjectIds) |
       length(t_subjectIds) != length(t_rowId) |
       length(c_subjectIds) != length(c_rowId)){
      print(sprintf("Error - mismatched target and comparator sample sizes"))
      print(sprintf("Error - length(t_id) = %s, length(c_id) = %s",
                    length(t_rowId), length(c_rowId)))
      print(sprintf("Error - length(t_subjectIds) = %s, length(c_subjectIds) = %s",
                    length(t_subjectIds), length(c_subjectIds)))
      next
    }
    
    # Populate cohort table
    sql <- readSql("populate_psm_cm_cohorts.sql")
    sql <- render(sql,
                  cohortDatabaseSchema = cohortDatabaseSchema,
                  cohortTable = paste0(cohortTable, "_", i),
                  t_cohort_id = t_cohort_id,
                  c_cohort_id = c_cohort_id,
                  t_subjectIds = t_subjectIds,
                  c_subjectIds = c_subjectIds)
    sql <- translate(sql, targetDialect = connectionDetails$dbms)
    executeSql(connection, sql)
    
    # Create placeholder
    file.create(paste0(wd, "/cohort_", i, "/psm_populated.csv"))
    
    rm(out_1, t_rowId, c_rowId, t_subjectIds, c_subjectIds, sql, t_cohort_id, c_cohort_id)
  }
  rm(cohortIds, df, cmData, out_1, t_rowId, c_rowId, t_subjectIds, c_subjectIds,
     sql, t_cohort_id, c_cohort_id)
}
rm(datafile, cohort_id)


# ==================================================================================================================
# Explore cohort table
# ==================================================================================================================

# # Test cohorts appropriately generated
# for(i in 1:num_cohorts){
#   
#   disconnect(connection)
#   connection <- connect(connectionDetails)
#   
#   sql <- paste("SELECT cohort_definition_id, COUNT(*) AS count",
#                "FROM @cohortDatabaseSchema.@cohortTable",
#                "GROUP BY cohort_definition_id",
#                "ORDER BY cohort_definition_id")
#   sql <- render(sql,
#                 cohortDatabaseSchema = cohortDatabaseSchema,
#                 cohortTable = paste0(cohortTable, "_", i))
#   sql <- translate(sql, targetDialect = connectionDetails$dbms)
#   print(querySql(connection, sql))
#   rm(sql)
# }


# ==================================================================================================================
# Perform cardinality matching
# ==================================================================================================================

# Define test file names
datafile <- c("fine.rds", "mom_001.rds", "mom_005.rds", "mom_010.rds")

# Perform cardinality matching
for(i in 1:num_cohorts){
  
  if(file.exists(paste0(wd, "/cohort_", i, "/", datafile[length(datafile)]))){
    print(paste("Cardinality matching already complete for cohort", i, "- moving to next cohort"))
    next
  }
  
  # Set parameters
  df <- read.csv(paste(wd, "/cohort_", i, "/df.csv", sep = ""))
  t_ind <- df[, "treatment"]
  t_max <- 60*60
  
  # Set solver options
  name <- "gurobi"
  approximate <- 0
  solver <- list(name = name, t_max = t_max, approximate = approximate,
                 round_cplex = 0, trace = 0)
  
  # Perform cardinality matching with fine balance
  if(!file.exists(paste(wd, paste0("cohort_", i), datafile[1], sep="/"))){
    
    print(paste("Performing cardinality matching with fine balance for cohort", i))
    
    # Set parameters
    fine_covs <- df[, -which(colnames(df) %in% c("treatment", "rowId", "Hospital.Frailty.Risk.Score..hfrs."))]
    fine <- list(covs = fine_covs)
    
    # Perform match (fine balance)                
    out_1 <- cardmatch(t_ind, fine = fine, solver = solver)
    
    # Print results
    print(paste0("Match found for cohort ", i, ". Saving results to ", datafile[1]))
    print(sprintf("Control group matched: %s", length(out_1$c_id)))
    print(sprintf("Treatment group matched: %s", length(out_1$t_id)))
    
    # Save results
    saveRDS(out_1, file = paste0(wd, "/cohort_", i, "/", datafile[1]))
    
    rm(fine_covs, fine, out_1)
  } else{
    print(paste("Cardinality matching with fine balance already performed for cohort", i))
  }
  
  # Perform cardinality matching with MOM balance
  for(j in 2:length(datafile)){
    
    if(file.exists(paste0(wd, "/cohort_", i, "/", datafile[j]))){
      print(paste0("Cardinality matching with MOM balance (", j, ") already completed for cohort ", i))
      next
    } else{
      print(paste0("Performing MOM matching (", j, ") for cohort ", i))
    }
    
    # Set parameters
    if(j == 2){
      max_stdiff <- 0.01
    } else if(j == 3){
      max_stdiff <- 0.05
    } else {
      max_stdiff <- 0.10
    }
    mom_targets <- NULL
    mom_covs <- df[, -which(colnames(df) %in% c("treatment", "rowId", "Hospital.Frailty.Risk.Score..hfrs."))]
    mom_tols = absstddif(mom_covs, t_ind, max_stdiff)
    mom_covs <- df[, -which(colnames(df) %in% c("treatment", "rowId", "Hospital.Frailty.Risk.Score..hfrs."))]
    mom=list(covs=mom_covs, tols=mom_tols, targets=mom_targets)
    
    # Perform match (moment balance)
    out_1 <- cardmatch(t_ind, mom = mom, solver = solver)
    
    # Print results
    print(paste0("Match found for cohort ", i, ". Saving results to ", datafile[j]))
    print(sprintf("Control group matched: %s", length(out_1$c_id)))
    print(sprintf("Treatment group matched: %s", length(out_1$t_id)))
    
    # Save results
    saveRDS(out_1, paste0(wd, "/cohort_", i, "/", datafile[j]))
    
    rm(max_stdiff, mom_covs, mom_targets, mom_tols, mom, out_1)
  }
  rm(df, t_max, t_ind, name, approximate, solver)
}
rm(datafile, i, j)


# ==================================================================================================================
# Verify cardinality matching convergence and equally matched groups
# ==================================================================================================================

# Define test file names
datafile <- c("fine.rds", "mom_001.rds", "mom_005.rds", "mom_010.rds")

# Create empy dataframes
no_matches <- data.frame(matrix(0, nrow = 0, ncol = 2, dimnames = list(NULL, c("cohort", "cm"))))
unbal_matches <- data.frame(matrix(0, nrow = 0, ncol = 4, 
                                   dimnames = list(NULL, c("cohort", "cm", "t_id", "c_id"))))

for(i in 1:num_cohorts){
  for(j in 1:length(datafile)){
    
    # Load data
    out_1 <- readRDS(paste0(wd, "/cohort_", i, "/", datafile[j]))
    t_id <- out_1$t_id
    c_id <- out_1$c_id
    
    if(length(t_id) == 0){
      no_matches <- rbind(no_matches, c(i, j))
      colnames(no_matches) <- c("cohort", "cm")
    }
    
    if(length(t_id) != length(c_id)){
      unbal_matches <- rbind(unbal_matches, c(i, j, length(t_id), length(c_id)))
      colnames(unbal_matches) <- c("cohort", "cm", "t_id", "c_id")
    }
    
    rm(out_1, t_id, c_id)
  }
}
rm(datafile)

print(no_matches)
print(unbal_matches)


# ==================================================================================================================
# Populate SQL tables with cardinality-matched populations
# ==================================================================================================================

# Set parameters
datafile <- c("fine.rds", "mom_001.rds", "mom_005.rds", "mom_010.rds")
cohort_id <- list(c(5,6), c(7,8), c(9,10), c(11,12))

# Populate cohort tables with cardinality-matched tables
for(i in 1:num_cohorts){
  
  if(file.exists(paste0(wd, "/cohort_", i, "/cm_populated.csv"))){
    print(paste("Cardinality-matched sample populated in cohort table for cohort", i, "exists - moving to next cohort"))
    next
  } else{
    print(paste("Populating cardinality-matched sample in cohort table for cohort", i))
  }
  
  # Load data
  cmData <- loadCohortMethodData(paste0(wd, "/cohort_", i, "/cmData"))
  df <- read.csv(paste(wd, "/cohort_", i, "/df.csv", sep = ""))
  
  # Obtain list of cohortIds currently within cohort data frame
  sql <- paste("SELECT cohort_definition_id",
               "FROM @cohortDatabaseSchema.@cohortTable",
               "GROUP BY cohort_definition_id")
  sql <- render(sql,
                cohortDatabaseSchema = cohortDatabaseSchema,
                cohortTable = paste0(cohortTable, "_", i))
  sql <- translate(sql, targetDialect = connectionDetails$dbms)
  cohortIds <- querySql(connection, sql)
  
  for(j in 1:length(datafile)){
    
    if(sum(cohort_id[[j]] %in% cohortIds$COHORT_DEFINITION_ID) == 2){
      print(paste("Datafile", datafile[j], "already uploaded"))
      next
    } else{
      print(paste("Uploading datafile", datafile[j]))
    }
    
    # Set parameters
    t_cohort_id <- cohort_id[[j]][1]
    c_cohort_id <- cohort_id[[j]][2]
    
    # Get matched rowIds
    out_1 <- readRDS(paste0(wd, "/cohort_", i, "/", datafile[j]))
    t_id <- out_1$t_id
    c_id <- out_1$c_id
    t_rowId <- df[t_id, "rowId"]
    c_rowId <- df[c_id, "rowId"]
    
    # Skip when no matched patients
    if(length(t_rowId) == 0 | length(c_rowId) == 0){
      next
    }
    
    # Determine subjectIds
    t_subjectIds <- unique(cmData$cohorts$subjectId[cmData$cohorts$subjectId %in% t_rowId])
    c_subjectIds <- unique(cmData$cohorts$subjectId[cmData$cohorts$subjectId %in% c_rowId])
    
    # Verify lengths of vectors are matched
    if(length(t_subjectIds) != length(c_subjectIds) |
       length(t_subjectIds) != length(t_rowId) |
       length(c_subjectIds) != length(c_rowId)){
      print(sprintf("Error - mismatched target and comparator sample sizes"))
      print(sprintf("Error - length(t_id) = %s, length(c_id) = %s",
                    length(t_rowId), length(c_rowId)))
      print(sprintf("Error - length(t_subjectIds) = %s, length(c_subjectIds) = %s",
                    length(t_subjectIds), length(c_subjectIds)))
      next
    }
    
    # Populate cohort table
    sql <- readSql("populate_psm_cm_cohorts.sql")
    sql <- render(sql,
                  cohortDatabaseSchema = cohortDatabaseSchema,
                  cohortTable = paste0(cohortTable, "_", i),
                  t_cohort_id = t_cohort_id,
                  c_cohort_id = c_cohort_id,
                  t_subjectIds = t_subjectIds,
                  c_subjectIds = c_subjectIds)
    sql <- translate(sql, targetDialect = connectionDetails$dbms)
    executeSql(connection, sql)
    
    rm(out_1, t_id, c_id, t_rowId, c_rowId, t_subjectIds, c_subjectIds, sql, t_cohort_id, c_cohort_id)
  }
  rm(cohortIds, df, cmData, out_1, t_id, c_id, t_rowId, c_rowId, t_subjectIds, c_subjectIds,
     sql, t_cohort_id, c_cohort_id)
  
  # Create placeholder
  file.create(paste0(wd, "/cohort_", i, "/cm_populated.csv"))
}
rm(datafile, cohort_id)


# ==================================================================================================================
# Explore cohort table
# ==================================================================================================================

# # Test cohorts appropriately generated
# for(i in 1:num_cohorts){
#   sql <- paste("SELECT cohort_definition_id, COUNT(*) AS count",
#                "FROM @cohortDatabaseSchema.@cohortTable",
#                "GROUP BY cohort_definition_id",
#                "ORDER BY cohort_definition_id")
#   sql <- render(sql,
#                 cohortDatabaseSchema = cohortDatabaseSchema,
#                 cohortTable = paste0(cohortTable, "_", i))
#   sql <- translate(sql, targetDialect = connectionDetails$dbms)
#   print(querySql(connection, sql))
#   temp <- querySql(connection, sql)
#   rm(sql, temp)
# }


# ==================================================================================================================
# Run Analyses for OVerall Sample
# ==================================================================================================================

# Specifying hypotheses of interest
tcos <- createTargetComparatorOutcomes(targetId = 1,
                                       comparatorId = 2,
                                       outcomeIds = c(3, ncs))
targetComparatorOutcomesList <- list(tcos)

# Target and comparator ingredient concepts
aceI <- c(1335471,1340128,1341927,1363749,1308216,1310756,1373225, 1331235,1334456,1342439)
bblock <- c(1353766, 1345858, 1327978, 1314577, 1313200, 1307046, 1386957, 1346823, 1338005, 1322081, 1314002, 1319998)

# Define which types of covariates must be constructed
cs <- createDefaultCovariateSettings(excludedCovariateConceptIds = c(aceI, bblock),
                                     addDescendantsToExclude = TRUE)

# Define Args
cmdArgs <- createGetDbCohortMethodDataArgs(
  studyStartDate = "",
  studyEndDate = "",
  firstExposureOnly = FALSE,
  removeDuplicateSubjects = FALSE,
  restrictToCommonPeriod = FALSE,
  washoutPeriod = 365,
  covariateSettings = cs)
spArgs <- createCreateStudyPopulationArgs(
  firstExposureOnly = FALSE,
  restrictToCommonPeriod = FALSE,
  washoutPeriod = 365,
  removeDuplicateSubjects = "remove all",
  removeSubjectsWithPriorOutcome = TRUE,
  minDaysAtRisk = 1,
  startAnchor = "cohort start",
  addExposureDaysToStart = FALSE,
  endAnchor = "cohort end",
  addExposureDaysToEnd = TRUE)
fomArgsT <- createFitOutcomeModelArgs(
  modelType = "cox",
  stratified = FALSE)

# Define analyses
cmAnalysis1 <- createCmAnalysis(
  analysisId = 1,
  description = "Overall Sample",
  getDbCohortMethodDataArgs = cmdArgs,
  createStudyPopArgs = spArgs,
  createPs = FALSE,
  createPsArgs = NULL,
  matchOnPs = FALSE,
  matchOnPsArgs = NULL,
  fitOutcomeModel = TRUE,
  fitOutcomeModelArgs = fomArgsT)
cmAnalysisList <- list(cmAnalysis1)

rm(tcos, aceI, bblock, cs, cmdArgs, spArgs, fomArgsT, cmAnalysis1)

# Run cmAnalyses
for(i in 1:num_cohorts){
  
  # Define output folder
  outputFolder <- paste(wd, paste("cohort", i, sep="_"), "Results_1", sep="/")
  
  if(file.exists(paste(outputFolder, "analysisSummary.rds", sep="/"))){
    rm(outputFolder)
    print(paste("Analyses completed for cohort", i, "- moving to next cohort"))
    next
  } else{
    print(paste("Performing analyses for cohort", i))
  }
  
  try(result <- runCmAnalyses(connectionDetails = connectionDetails,
                          cdmDatabaseSchema = cdmDatabaseSchema,
                          exposureDatabaseSchema = cohortDatabaseSchema,
                          exposureTable = paste0(cohortTable, "_", i),
                          outcomeDatabaseSchema = cohortDatabaseSchema,
                          outcomeTable = cohortOutcomeTable,
                          cdmVersion = cdmVersion,
                          outputFolder = outputFolder,
                          cmAnalysisList = cmAnalysisList,
                          targetComparatorOutcomesList = targetComparatorOutcomesList))
  
  try(analysisSum <- summarizeAnalyses(result, outputFolder))
  try(saveRDS(analysisSum, paste(outputFolder, "analysisSummary.rds", sep="/")))
  
  rm(outputFolder, result, analysisSum)
}
rm(cmAnalysisList, targetComparatorOutcomesList)


# ==================================================================================================================
# Run Analyses for PSM
# ==================================================================================================================

# Specifying hypotheses of interest
tcos <- createTargetComparatorOutcomes(targetId = 19,
                                       comparatorId = 20,
                                       outcomeIds = c(3, ncs))
targetComparatorOutcomesList <- list(tcos)

# Target and comparator ingredient concepts
aceI <- c(1335471,1340128,1341927,1363749,1308216,1310756,1373225, 1331235,1334456,1342439)
bblock <- c(1353766, 1345858, 1327978, 1314577, 1313200, 1307046, 1386957, 1346823, 1338005, 1322081, 1314002, 1319998)

# Define which types of covariates must be constructed
cs <- createDefaultCovariateSettings(excludedCovariateConceptIds = c(aceI, bblock),
                                     addDescendantsToExclude = TRUE)

# Define Args
cmdArgs <- createGetDbCohortMethodDataArgs(
  studyStartDate = "",
  studyEndDate = "",
  firstExposureOnly = FALSE,
  removeDuplicateSubjects = FALSE,
  restrictToCommonPeriod = FALSE,
  washoutPeriod = 365,
  covariateSettings = cs)
spArgs <- createCreateStudyPopulationArgs(
  firstExposureOnly = FALSE,
  restrictToCommonPeriod = FALSE,
  washoutPeriod = 365,
  removeDuplicateSubjects = "remove all",
  removeSubjectsWithPriorOutcome = TRUE,
  minDaysAtRisk = 1,
  startAnchor = "cohort start",
  addExposureDaysToStart = FALSE,
  endAnchor = "cohort end",
  addExposureDaysToEnd = TRUE)
fomArgsT <- createFitOutcomeModelArgs(
  modelType = "cox",
  stratified = FALSE)

# Define analyses
cmAnalysis1 <- createCmAnalysis(
  analysisId = 1,
  description = "PSM, caliper=0.15",
  getDbCohortMethodDataArgs = cmdArgs,
  createStudyPopArgs = spArgs,
  createPs = FALSE,
  createPsArgs = NULL,
  matchOnPs = FALSE,
  matchOnPsArgs = NULL,
  fitOutcomeModel = TRUE,
  fitOutcomeModelArgs = fomArgsT)
cmAnalysisList <- list(cmAnalysis1)

rm(tcos, aceI, bblock, cs, cmdArgs, spArgs, fomArgsT, cmAnalysis1)

# Run cmAnalyses
for(i in 1:num_cohorts){

  # Define output folder
  outputFolder <- paste(wd, paste("cohort", i, sep="_"), "Results_2", sep="/")

  if(file.exists(paste(outputFolder, "analysisSummary.rds", sep="/"))){
    rm(outputFolder)
    print(paste("Analyses completed for cohort", i, "- moving to next cohort"))
    next
  } else{
    print(paste("Performing analyses for cohort", i))
  }

  try(result <- runCmAnalyses(connectionDetails = connectionDetails,
                          cdmDatabaseSchema = cdmDatabaseSchema,
                          exposureDatabaseSchema = cohortDatabaseSchema,
                          exposureTable = paste0(cohortTable, "_", i),
                          outcomeDatabaseSchema = cohortDatabaseSchema,
                          outcomeTable = cohortOutcomeTable,
                          cdmVersion = cdmVersion,
                          outputFolder = outputFolder,
                          cmAnalysisList = cmAnalysisList,
                          targetComparatorOutcomesList = targetComparatorOutcomesList))

  try(analysisSum <- summarizeAnalyses(result, outputFolder))
  try(saveRDS(analysisSum, paste(outputFolder, "analysisSummary.rds", sep="/")))

  rm(outputFolder, result, analysisSum)
}
rm(cmAnalysisList, targetComparatorOutcomesList)


# ==================================================================================================================
# Run Analyses - CM
# ==================================================================================================================

# Define parameters
cohort_id <- list(c(5,6), c(7,8), c(9,10), c(11,12))
description <- c("CM Fine Match", "CM SMD 001", "CM SMD 005", "CM SMD 010")

# Target and comparator ingredient concepts
aceI <- c(1335471,1340128,1341927,1363749,1308216,1310756,1373225, 1331235,1334456,1342439)
bblock <- c(1353766, 1345858, 1327978, 1314577, 1313200, 1307046, 1386957, 1346823, 1338005, 1322081, 1314002, 1319998)

# Define which types of covariates must be constructed
cs <- createDefaultCovariateSettings(excludedCovariateConceptIds = c(aceI, bblock),
                                     addDescendantsToExclude = TRUE)

# Define Args
cmdArgs <- createGetDbCohortMethodDataArgs(
  studyStartDate = "",
  studyEndDate = "",
  firstExposureOnly = FALSE,
  removeDuplicateSubjects = FALSE,
  restrictToCommonPeriod = FALSE,
  washoutPeriod = 365,
  covariateSettings = cs)
spArgs <- createCreateStudyPopulationArgs(
  firstExposureOnly = FALSE,
  restrictToCommonPeriod = FALSE,
  washoutPeriod = 365,
  removeDuplicateSubjects = "remove all",
  removeSubjectsWithPriorOutcome = TRUE,
  minDaysAtRisk = 1,
  startAnchor = "cohort start",
  addExposureDaysToStart = FALSE,
  endAnchor = "cohort end",
  addExposureDaysToEnd = TRUE)
fomArgsF <- createFitOutcomeModelArgs(
  modelType = "cox",
  stratified = FALSE)

for(j in 1:length(cohort_id)){
  assign(paste0("tcos_", j), 
         createTargetComparatorOutcomes(targetId = cohort_id[[j]][1], 
                                        comparatorId = cohort_id[[j]][2], 
                                        outcomeIds = c(3, ncs)))
  assign(paste0("targetComparatorOutcomesList_", j),
         list(get(paste0("tcos_", j))))
  assign(paste0("cmAnalysis_", j),
         createCmAnalysis(analysisId = j,
                          description = description[j],
                          getDbCohortMethodDataArgs = cmdArgs,
                          createStudyPopArgs = spArgs,
                          createPs = FALSE,
                          createPsArgs = NULL,
                          matchOnPs = FALSE,
                          matchOnPsArgs = NULL,
                          fitOutcomeModel = TRUE,
                          fitOutcomeModelArgs = fomArgsF))
  assign(paste0("cmAnalysisList", j), list(get(paste0("cmAnalysis_", j))))
}
rm(list = ls(pattern = "tcos_")); rm(list = ls(pattern = "cmAnalysis_"))
rm(cohort_id, aceI, bblock, cs, description, cmdArgs, spArgs, fomArgsF)

# Run cmAnalyses
datafile <- c("fine.rds", "mom_001.rds", "mom_005.rds", "mom_010.rds")
for(i in 1:num_cohorts){
  print(paste("Performing analyses for cohort", i))
  
  for(j in 1:length(datafile)){
    
    if(nrow(subset(no_matches, cohort == i & cm == j)) == 1){
      next
    }
    
    # Define output folder
    outputFolder <- paste(wd, paste0("cohort_", i), paste0("Results_3_", j), sep="/")
    
    if(file.exists(paste(outputFolder, "analysisSummary.rds", sep="/"))){
      rm(outputFolder)
      print(paste("Analyses completed for cohort", i, "- datafile", datafile[j]))
      next
    } else{
      print(paste("Performing analyses for cohort", i, "- datafile", datafile[j]))
    }
    
    try(result <- runCmAnalyses(connectionDetails = connectionDetails,
                            cdmDatabaseSchema = cdmDatabaseSchema,
                            exposureDatabaseSchema = cohortDatabaseSchema,
                            exposureTable = paste0(cohortTable, "_", i),
                            outcomeDatabaseSchema = cohortDatabaseSchema,
                            outcomeTable = cohortOutcomeTable,
                            cdmVersion = cdmVersion,
                            outputFolder = outputFolder,
                            cmAnalysisList = get(paste0("cmAnalysisList", j)),
                            targetComparatorOutcomesList = get(paste0("targetComparatorOutcomesList_", j))))
    
    try(analysisSum <- summarizeAnalyses(result, outputFolder))
    try(saveRDS(analysisSum, paste(outputFolder, "analysisSummary.rds", sep="/")))
    
    rm(outputFolder, result, analysisSum)
  }
}
rm(datafile); rm(list = ls(pattern = "cmAnalysisList")); rm(list = ls(pattern = "targetComparatorOutcomesList_"))


# ==================================================================================================================
# Create covariate balance objects
# ==================================================================================================================

# Create balance objects - for PSM and CM (overall sample contained in objects by default)
balance_files <- paste0("balance_", 1:5)
datafile <- c("psm.rds", "fine.rds", "mom_001.rds", "mom_005.rds", "mom_010.rds")
source("computeCovariateBalance_SF.R")

for(i in 1:num_cohorts){
  print(paste("Performing balance calculations for cohort", i))
  
  # Find matching covariate ids
  if(!file.exists(paste(wd, paste0("cohort_", i), paste0("balance_", 5, ".rds"), sep="/"))){
    cmData <- loadCohortMethodData(paste0(wd, "/cohort_", i, "/cmData"))
    studyPop <- createStudyPopulation(cohortMethodData = cmData,
                                      outcomeId = 3,
                                      firstExposureOnly = FALSE,
                                      restrictToCommonPeriod = FALSE,
                                      washoutPeriod = 365,
                                      removeDuplicateSubjects = "remove all",
                                      removeSubjectsWithPriorOutcome = FALSE,
                                      minDaysAtRisk = 1,
                                      riskWindowStart =1,
                                      startAnchor = "cohort start",
                                      riskWindowEnd = 0,
                                      endAnchor = "cohort end")
    df <- read.csv(paste(wd, paste0("cohort_", i), "df.csv", sep="/"))
  } else{
    next
  }
  
  for(j in 1:5){
    
    # Skip calculating balance object for CM with unbalanced or no matches
    if(nrow(subset(no_matches, cohort == i & cm == (j-1))) != 0){
      print(paste("No matches for cohort", i, "data file", datafile[j], "- skipping"))
      next
    } else if(nrow(subset(unbal_matches, cohort == i & cm == (j-1))) != 0){
      print(paste("Unbalanced matches for cohort", i, "data file", datafile[j], "- skipping"))
      next
    }
    
    # Determine rowIds
    if(j == 1){
      # For PSM
      out_1 <- readRDS(paste(wd, paste0("cohort_", i), datafile[(j)], sep="/"))
      t_id <- which(!is.na(out_1$match.matrix))
      c_id <- as.numeric(out_1$match.matrix[!is.na(out_1$match.matrix)])
      rowIds <- df[c(t_id, c_id), "rowId"]
    } else if(j != 1){
      # For CM
      out_1 <- readRDS(paste(wd, paste0("cohort_", i), datafile[(j)], sep="/"))
      t_id <- out_1$t_id
      c_id <- out_1$c_id
      rowIds <- df[c(t_id, c_id), "rowId"]
    }
    
    # Create matched population 
    matchedPop <- studyPop[studyPop$subjectId %in% rowIds, ]    # studyPop[studyPop$rowId %in% rowIds, ]
    matchedPop$propensityScore <- 0.50
    matchedPop$preferenceScore <- 0.50
    
    # Create balance object
    balance <- computeCovariateBalance_SF(population = matchedPop, cohortMethodData = cmData, rowIds = rowIds)
    balance$match_var <- 0
    temp_balance <- balance_mvars(X_mat = df[, colnames(df) %in% c("rowId", "treatment", "Hospital.Frailty.Risk.Score..hfrs.") == FALSE],
                                  cohort_mat = df$treatment,
                                  t_id = t_id, c_id = c_id)
    temp_balance$match_var <- 1
    balance <- rbind(balance, temp_balance)
    
    # Save balance object
    if(file.exists(paste(wd, paste0("cohort_", i), paste0("balance_", j, ".rds"), sep="/"))){
      file.remove(paste(wd, paste0("cohort_", i), paste0("balance_", j, ".rds"), sep="/"))
    }
    saveRDS(balance, file = paste(wd, paste0("cohort_", i), paste0("balance_", j, ".rds"), sep="/"))
    
    rm(out_1, t_id, c_id, rowIds, matchedPop, balance, temp_balance)
  }
  
  rm(cmData, studyPop, df, j)
}
rm(datafile, balance_files, computeCovariateBalance_SF, computeMeanAndSd, computeMeansPerGroup, quickSum, balance_mvars)


# ==================================================================================================================
# Create covariate balance plots and summary data
# ==================================================================================================================

# Check for inappropriately balanced cohorts (appears to occur at the create_cm_df phase)
for(i in 1:num_cohorts){
  # Skip cohorts improperly balanced cohorts
  if(i %in% unbal_matches$cohort){
    print(paste("Unbalanced matches for cohort", i,  "- skipping"))
    next
  }
  
  # CM, fine match
  j <- 2
  balance <- readRDS(paste(wd, paste0("cohort_", i), paste0("balance_", j, ".rds"), sep="/"))
  
  if(sum(abs(balance$afterMatchingStdDiff[balance$match_var == 1]) > 0.01) > 0){
    unbal_matches <- rbind(unbal_matches, c(i, 0, 0, 0))
  }
  
  rm(balance, j)
}

# Create object lists / statistics
datafile <- c("psm.rds", "fine.rds", "mom_001.rds", "mom_005.rds", "mom_010.rds")
num_cov_candidates <- vector()
num_match_cov <- vector()
num_all_cov_list <- list()
bal_list <- list()
num_imbal_cov <- list()
num_imbal_match_cov <- list()
num_imbal_cov_pre <- vector()
for(j in 1:5){
  num_all_cov_list[[j]] <- vector()
  bal_list[[j]] <- list()
  num_imbal_cov[[j]] <- vector()
  num_imbal_match_cov[[j]] <- vector()
}
for(i in 1:num_cohorts){
  # Skip cohorts improperly balanced cohorts
  if(i %in% unbal_matches$cohort){
    print(paste("Unbalanced matches for cohort", i,  "- skipping"))
    next
  }
  
  for(j in 1:5){
    
    # Check for lack a matches / balance
    if(nrow(subset(no_matches, cohort == i & cm == (j-1)))){
      print(paste("No matches for cohort", i, "data file", datafile[j], "- skipping"))
      next
    }
    
    # Load balance object
    balance <- readRDS(paste(wd, paste0("cohort_", i), paste0("balance_", j, ".rds"), sep="/"))
    
    # Define cohort level parameters
    if(j == 1){
      num_cov_candidates <- c(num_cov_candidates, nrow(balance))
      num_match_cov <- c(num_match_cov, sum(balance$match_var == 1))
      num_imbal_cov_pre <- c(num_imbal_cov_pre,
                             sum(abs(balance$beforeMatchingStdDiff[!is.na(balance$beforeMatchingStdDiff)]) > 0.10))
    }
    
    num_imbal_cov[[j]] <- c(num_imbal_cov[[j]],
                            sum(abs(balance$afterMatchingStdDiff[!is.na(balance$beforeMatchingStdDiff) & !is.na(balance$afterMatchingStdDiff)]) > 0.10))
    num_imbal_match_cov[[j]] <- c(num_imbal_match_cov[[j]],
                                  sum(abs(balance$afterMatchingStdDiff[!is.na(balance$afterMatchingStdDiff) & balance$match_var == 1]) > 0.10))
    num_all_cov_list[[j]] <- c(num_all_cov_list[[j]], 
                               nrow(balance[!is.na(balance$beforeMatchingStdDiff) & !is.na(balance$afterMatchingStdDiff), ]))
    bal_list[[j]][[length(bal_list[[j]]) + 1]] <- balance
    
    rm(balance)
  }
}

# Create balance plots
bal_match_plt_list <- list()
bal_all_plt_list <- list()
bal_match <- list()
bal_all <- list()
smd_summary_list <- list()
titles <- c("PSM, caliper=0.15", 
            "CM, exact marginal distributional balance", 
            "CM, maximum SMD=0.01", 
            "CM, maximum SMD=0.05", 
            "CM, maximum smd=0.10")
for(j in 1:5){
  # Merge and clean cohorts
  balance <- do.call(rbind, bal_list[[j]])
  balance <- balance[!is.na(balance$beforeMatchingStdDiff) & !is.na(balance$afterMatchingStdDiff), ]
  n_cohorts <- length(balance[[j]])
  
  # Set parameters
  title_match <- titles[j]
  title_all <- titles[j]
  bal_match[[j]] <- balance[balance$match_var == 1, ]
  bal_all[[j]] <- balance

  # Create plots
  bal_match_plt_list[[j]] <- plotCovariateBalanceScatterPlot(balance = balance[balance$match_var == 1, ], 
                                                             showCovariateCountLabel = FALSE, 
                                                             showMaxLabel = FALSE,
                                                             title = title_match)
  bal_all_plt_list[[j]] <- plotCovariateBalanceScatterPlot(balance = balance, 
                                                           showCovariateCountLabel = FALSE, 
                                                           showMaxLabel = FALSE,
                                                           title = title_all)
  
  # Save summary information on SMDs
  smd_summary_list[[j]] <- cbind(summary(abs(balance$beforeMatchingStdDiff)[balance$match_var == 1]),
                                 summary(abs(balance$afterMatchingStdDiff)[balance$match_var == 1]),
                                 summary(abs(balance$beforeMatchingStdDiff)),
                                 summary(abs(balance$afterMatchingStdDiff)))
  colnames(smd_summary_list[[j]]) <- c("smd_before_match_match_vars",
                                       "smd_after_match_match_vars",
                                       "smd_before_match_all_vars",
                                       "smd_after_match_all_vars")
  smd_summary_list[[j]] <- rbind(smd_summary_list[[j]],
                                 c(sd(abs(balance$beforeMatchingStdDiff)[balance$match_var == 1]),
                                   sd(abs(balance$afterMatchingStdDiff)[balance$match_var == 1]),
                                   sd(abs(balance$beforeMatchingStdDiff)),
                                   sd(abs(balance$afterMatchingStdDiff))))
  row.names(smd_summary_list[[j]])[7] <- "sd"
  
  rm(balance, n_cohorts, title_match, title_all)
}
rm(datafile, bal_list)

# # Plot
# wb <- createWorkbook()
# addWorksheet(wb, "smds", gridLines = FALSE)
# for(j in 1:5){
#   plot(bal_match_plt_list[[j]])
#   insertPlot(wb = wb, sheet = 1, width = 6, height = 4, units = "in",
#              startRow = 4+20*j-20, startCol = 2)
# 
#   plot(bal_all_plt_list[[j]])
#   insertPlot(wb = wb, sheet = 1, width = 6, height = 4, units = "in",
#              startRow = 4+20*j-20, startCol = 2+10)
# }
# saveWorkbook(wb, "smds.xlsx", overwrite = TRUE)
# rm(wb)


# ==================================================================================================================
# Run joint analyses
# ==================================================================================================================

if(!file.exists(paste0(wd, "jointCohortPopulated.csv"))){
  
  # Create joint cohort table
  sql <- readSql("createJointCohortTable.sql")
  sql <- render(sql,
                cohort_database_schema = cohortDatabaseSchema,
                cohortTable = paste0(cohortTable, "_joint"))
  sql <- translate(sql, targetDialect = connectionDetails$dbms)
  executeSql(connection, sql)
  rm(sql)
  
  # Populate joint cohort table
  for(i in 1:num_cohorts){
    
    # Skip cohorts improperly balanced cohorts
    if(i %in% unbal_matches$cohort){
      print(paste("Unbalanced matches for cohort", i,  "- skipping"))
      next
    }
    
    sql <- readSql("populateJointCohortTable.sql")
    sql <- render(sql,
                  cohortDatabaseSchema = cohortDatabaseSchema,
                  cohortJointTable = paste0(cohortTable, "_joint"),
                  cohortTable = paste0(cohortTable, "_", i))
    sql <- translate(sql, targetDialect = connectionDetails$dbms)
    executeSql(connection, sql)
    rm(sql)
    
    # Create placeholder
    if(i == num_cohorts){
      file.create(paste0(wd, "jointCohortPopulated.csv"))
    }
  }
}

# Define parameters
cohort_id <- list(c(1,2), c(19, 20), c(5,6), c(7,8), c(9,10), c(11,12))
description <- c("Pre-Match", "PSM", "CM Fine Match", "CM SMD 001", "CM SMD 005", "CM SMD 010")

# Target and comparator ingredient concepts
aceI <- c(1335471,1340128,1341927,1363749,1308216,1310756,1373225, 1331235,1334456,1342439)
bblock <- c(1353766, 1345858, 1327978, 1314577, 1313200, 1307046, 1386957, 1346823, 1338005, 1322081, 1314002, 1319998)

# Define which types of covariates must be constructed
cs <- createDefaultCovariateSettings(excludedCovariateConceptIds = c(aceI, bblock),
                                     addDescendantsToExclude = TRUE)

# Define Args
cmdArgs <- createGetDbCohortMethodDataArgs(
  studyStartDate = "",
  studyEndDate = "",
  firstExposureOnly = FALSE,
  removeDuplicateSubjects = FALSE,
  restrictToCommonPeriod = FALSE,
  washoutPeriod = 365,
  covariateSettings = cs)
spArgs <- createCreateStudyPopulationArgs(
  firstExposureOnly = FALSE,
  restrictToCommonPeriod = FALSE,
  washoutPeriod = 365,
  removeDuplicateSubjects = "remove all",
  removeSubjectsWithPriorOutcome = TRUE,
  minDaysAtRisk = 1,
  startAnchor = "cohort start",
  addExposureDaysToStart = FALSE,
  endAnchor = "cohort end",
  addExposureDaysToEnd = TRUE)
fomArgsF <- createFitOutcomeModelArgs(
  modelType = "cox",
  stratified = FALSE)

for(j in 1:length(cohort_id)){
  assign(paste0("tcos_", j), 
         createTargetComparatorOutcomes(targetId = cohort_id[[j]][1], 
                                        comparatorId = cohort_id[[j]][2], 
                                        outcomeIds = c(3, ncs)))
  assign(paste0("targetComparatorOutcomesList_", j),
         list(get(paste0("tcos_", j))))
  assign(paste0("cmAnalysis_", j),
         createCmAnalysis(analysisId = j,
                          description = description[j],
                          getDbCohortMethodDataArgs = cmdArgs,
                          createStudyPopArgs = spArgs,
                          createPs = FALSE,
                          createPsArgs = NULL,
                          matchOnPs = FALSE,
                          matchOnPsArgs = NULL,
                          fitOutcomeModel = TRUE,
                          fitOutcomeModelArgs = fomArgsF))
  assign(paste0("cmAnalysisList", j), list(get(paste0("cmAnalysis_", j))))
}
rm(list = ls(pattern = "tcos_")); rm(list = ls(pattern = "cmAnalysis_"))
rm(aceI, bblock, cs, description, cmdArgs, spArgs, fomArgsF)

# Run cmAnalyses
for(j in 1:length(cohort_id)){
  
  # Define output folder
  outputFolder <- paste(wd, paste0("jointResults_", j), sep="/")
  
  if(!dir.exists(paste(wd, paste0("jointResults_", j), sep="/"))){
    dir.create(paste(wd, paste0("jointResults_", j), sep="/"))
  }
  
  if(file.exists(paste(outputFolder, "analysisSummary.rds", sep="/"))){
    rm(outputFolder)
    print(paste("Analyses completed for joint cohort", j))
    next
  } else{
    print(paste("Performing analyses for joint cohort", j))
  }
  
  try(result <- runCmAnalyses(connectionDetails = connectionDetails,
                              cdmDatabaseSchema = cdmDatabaseSchema,
                              exposureDatabaseSchema = cohortDatabaseSchema,
                              exposureTable = paste0(cohortTable, "_joint"),
                              outcomeDatabaseSchema = cohortDatabaseSchema,
                              outcomeTable = cohortOutcomeTable,
                              cdmVersion = cdmVersion,
                              outputFolder = outputFolder,
                              cmAnalysisList = get(paste0("cmAnalysisList", j)),
                              targetComparatorOutcomesList = get(paste0("targetComparatorOutcomesList_", j))))
  
  try(analysisSum <- summarizeAnalyses(result, outputFolder))
  try(saveRDS(analysisSum, paste(outputFolder, "analysisSummary.rds", sep="/")))
  
  rm(outputFolder, result, analysisSum)
}
rm(list = ls(pattern = "cmAnalysisList")); rm(list = ls(pattern = "targetComparatorOutcomesList_"))


# ==================================================================================================================
# NCS plots: summary of all cohorts
# ==================================================================================================================

# Define parameters
negCons_list <- list()
hoi_list <- list()

for(j in 1:6){
  # Load data
  outputFolder <- paste(wd, paste0("jointResults_", j), sep="/")
  analysisSum <- readRDS(paste(outputFolder, "analysisSummary.rds", sep="/"))
  
  # Define parameters
  negCons <- analysisSum[analysisSum$analysisId == j & analysisSum$outcomeId != 3, ]
  hoi <-  analysisSum[analysisSum$analysisId == j & analysisSum$outcomeId == 3, ]
  
  negCons_list[[j]] <- negCons
  hoi_list[[j]] <- hoi
  
  rm(outputFolder, analysisSum, negCons, hoi)
}


# Create plots
plts <- list()
nulls <- list()
p_ncs <- list()
p_hoi <- list()
models <- vector(mode = "list", length = 6)
calibrate_estimates <- vector(mode = "list", length = 6)
datafile <- c("psm.rds", "fine.rds", "mom_001.rds", "mom_005.rds", "mom_010.rds")
titles <- c("PSM, caliper=0.15", 
            "CM, exact marginal distributional balance", 
            "CM, maximum SMD=0.01", 
            "CM, maximum SMD=0.05", 
            "CM, maximum smd=0.10")
for(j in 1:6){
  # Define parameters
  negCons <- negCons_list[[j]]
  hoi <- hoi_list[[j]]
  #null <- fitNull(negCons$logRr, negCons$seLogRr)
  null <- fitMcmcNull(negCons$logRr, negCons$seLogRr)
  n_cohorts <- nrow(hoi)
  if(j == 1){
    title <- "Pre-Match Sample"
  }else{
    title <- titles[j-1]
  }
  
  plts[[j]] <- plotCalibrationEffect(logRrNegatives = negCons$logRr, 
                                     seLogRrNegatives = negCons$seLogRr, 
                                     #      logRrPositives = hoi$logRr, 
                                     #      seLogRrPositives = hoi$seLogRr, 
                                     null = null,
                                     # showExpectedSystematicError = TRUE,
                                     title = title,
                                     showCis = TRUE)
  nulls[[j]] <- null
  
  # p_ncs[[j]] <- cbind(negCons[, c("rr", "ci95lb", "ci95ub", "outcomeId")], calibrateP(null, negCons$logRr, negCons$seLogRr))
  p_ncs[[j]] <- cbind(negCons[, c("rr", "ci95lb", "ci95ub", "outcomeId", "p")])
  p_hoi[[j]] <- cbind(hoi[, c("rr", "ci95lb", "ci95ub", "outcomeId")], calibrateP(null, hoi$logRr, hoi$seLogRr))
  
  models[[j]] <- convertNullToErrorModel(null)            
  calibrate_estimates[[j]] <- cbind(calibrateConfidenceInterval(logRr = hoi$logRr,
                                                                seLogRr = hoi$seLogRr, 
                                                                model = models[[j]],
                                                                ciWidth = 0.95),
                                    calibrateP(null, hoi$logRr, hoi$seLogRr))
  
  rm(negCons, hoi, title, null, n_cohorts)
}
rm(datafile, negCons_list, hoi_list)


# # Plot
# wb <- createWorkbook()
# addWorksheet(wb, "ncs", gridLines = FALSE)
# for(j in 1:6){
#   plot(plts[[j]])
#   insertPlot(wb = wb, sheet = 1, width = 6, height = 4, units = "in",
#              startRow = 4+20*j-20, startCol = 2)
# }
# saveWorkbook(wb, "ncs.xlsx", overwrite = TRUE)
# rm(wb)


# ==================================================================================================================
# Calibrated estimates
# ==================================================================================================================

# cal_est <- as.data.frame(do.call(rbind, calibrate_estimates))
# row.names(cal_est) <-c("Pre-match", 
#                        "PSM, caliper=0.15", 
#                        "CM, exact marginal distributional balance", 
#                        "CM, maximum SMD=0.01", 
#                        "CM, maximum SMD=0.05", 
#                        "CM, maximum smd=0.10")


# ==================================================================================================================
# Sample sizes
# ==================================================================================================================

sample_sizes <- list()
datafile <- c("psm.rds", "fine.rds", "mom_001.rds", "mom_005.rds", "mom_010.rds")
for(j in 1:5){
  sample_sizes[[j]] <- vector()
}
for(i in 1:num_cohorts){
  # Skip cohorts improperly balanced cohorts
  if(i %in% unbal_matches$cohort){
    print(paste("Unbalanced matches for cohort", i,  "- skipping"))
    next
  }
  
  for(j in 1:5){
    if(j == 1){
      m_out <- readRDS(paste(wd, paste0("cohort_", i), datafile[j], sep="/"))
      sample_sizes[[j]] <- c(sample_sizes[[j]], sum(!is.na(m_out$match.matrix))*2)
      
      rm(m_out)
    }else{
      out_1 <- readRDS(paste(wd, paste0("cohort_", i), datafile[j], sep="/"))
      t_id <- out_1$t_id
      c_id <- out_1$c_id
      sample_sizes[[j]] <- c(sample_sizes[[j]], (length(t_id) + length(c_id)))
      
      rm(out_1, t_id, c_id)
    }
  }
}

# Summarize sample size information
ss_df <- data.frame(t(apply(do.call(rbind, sample_sizes), 1, function(x) summary(x))))
ss_df$sd <- apply(do.call(rbind, sample_sizes), 1, function(x) sd(x))
ss_df$num_zero <- apply(do.call(rbind, sample_sizes), 1, function(x) sum(x == 0))
row.names(ss_df) <- c("PSM, caliper=0.15", 
                      "CM, exact marginal distributional balance", 
                      "CM, maximum SMD=0.01", 
                      "CM, maximum SMD=0.05", 
                      "CM, maximum smd=0.10")


# ==================================================================================================================
# NCS summary
# ==================================================================================================================

ncs_summary <- list()
for(j in 1:6){
  # Median sample size
  if(j == 1){
    sql <- paste("SELECT cohort_definition_id, COUNT(*) AS count",
                 "FROM @cohortDatabaseSchema.@cohortTable",
                 "WHERE cohort_definition_id IN (1, 2)",
                 "GROUP BY cohort_definition_id")
    sql <- render(sql,
                  cohortDatabaseSchema = cohortDatabaseSchema,
                  cohortTable = paste(cohortTable, "_", i, sep=""))
    sql <- translate(sql, targetDialect = connectionDetails$dbms)
    temp <- querySql(connection, sql)
    
    t <- temp$COUNT[temp$COHORT_DEFINITION_ID == 1]
    c <- temp$COUNT[temp$COHORT_DEFINITION_ID == 2]
    
    rm(temp, sql)
  } else{
    t <- ss_df[j-1, "Median"]
    c <- t
  }
  
  # Number cohorts with >0 matches
  if(j == 1){
    n_cohorts <- num_cohorts - nrow(unbal_matches)
  } else{
    n_cohorts <- num_cohorts - ss_df[j-1, "num_zero"] - nrow(unbal_matches)
  }
  
  # Number ncs
  n_ncs <- sum(!is.na(p_ncs[[j]]$p))
  
  # Number p<0.05
  n_ncs_05 <- sum(!is.na(p_ncs[[j]]$p) & p_ncs[[j]]$p < 0.05)
  
  # Number hoi
  n_hoi <- sum(!is.na(p_hoi[[j]]$p))
  
  # Number hoi p<0.05
  n_hoi_05 <- sum(!is.na(p_hoi[[j]]$p) & p_hoi[[j]]$p < 0.05)
  
  ncs_summary[[j]] <- c(t, c, n_cohorts, n_ncs, n_ncs_05, n_hoi, n_hoi_05)
  
  rm(t, c, n_cohorts, n_ncs, n_ncs_05, n_hoi, n_hoi_05)
}

ncs_summary <- data.frame(do.call(rbind, ncs_summary))
row.names(ncs_summary) <- c("Pre-match", 
                            "PSM, caliper=0.15", 
                            "CM, exact marginal distributional balance", 
                            "CM, maximum SMD=0.01", 
                            "CM, maximum SMD=0.05", 
                            "CM, maximum smd=0.10")
colnames(ncs_summary) <- c("median_t", " median_c", "n_cohorts", "n_ncs", "n_ncs_p<05", "n_hoi", "n_hoi_p<05")


# ==================================================================================================================
# SMD Summary
# ==================================================================================================================

match_smds <- t(smd_summary_list[[1]][, 1])
all_smds <- t(smd_summary_list[[1]][, 3])
for(j in 1:length(smd_summary_list)){
  match_smds <- rbind(match_smds, t(smd_summary_list[[j]][, 2]))
  all_smds <- rbind(all_smds, t(smd_summary_list[[j]][, 4]))
}
row.names(match_smds) <- c("Pre-match", 
                           "PSM, caliper=0.15", 
                           "CM, exact marginal distributional balance", 
                           "CM, maximum SMD=0.01", 
                           "CM, maximum SMD=0.05", 
                           "CM, maximum smd=0.10")
row.names(all_smds) <- c("Pre-match", 
                         "PSM, caliper=0.15", 
                         "CM, exact marginal distributional balance", 
                         "CM, maximum SMD=0.01", 
                         "CM, maximum SMD=0.05", 
                         "CM, maximum smd=0.10")


# ==================================================================================================================
# Number Covariates Summary
# ==================================================================================================================

num_covs <- rbind(c(summary(num_cov_candidates), 
                    sd = sd(num_cov_candidates), 
                    sum =sum(num_cov_candidates), 
                    n = length(num_cov_candidates)), 
                  c(summary(num_match_cov), 
                    sd = sd(num_match_cov), 
                    sum = sum(num_match_cov), 
                    n = length(num_match_cov)),
                  c(summary(num_imbal_cov_pre), 
                    sd = sd(num_imbal_cov_pre), 
                    sum = sum(num_imbal_cov_pre), 
                    n = length(num_imbal_cov_pre)))
for(j in 1:length(num_all_cov_list)){
  num_covs <- rbind(num_covs,
                    c(summary(num_all_cov_list[[j]][!is.na(num_imbal_match_cov[[j]])]), 
                      sd = sd(num_all_cov_list[[j]][!is.na(num_imbal_match_cov[[j]])]), 
                      sum = sum(num_all_cov_list[[j]][!is.na(num_imbal_match_cov[[j]])]), 
                      n = length(num_all_cov_list[[j]][!is.na(num_imbal_match_cov[[j]])])),
                    c(summary(num_imbal_cov[[j]][!is.na(num_imbal_match_cov[[j]])]), 
                      sd = sd(num_imbal_cov[[j]][!is.na(num_imbal_match_cov[[j]])]), 
                      sum = sum(num_imbal_cov[[j]][!is.na(num_imbal_match_cov[[j]])]), 
                      n = length(num_imbal_cov[[j]][!is.na(num_imbal_match_cov[[j]])])),
                    c(summary(num_imbal_match_cov[[j]][!is.na(num_imbal_match_cov[[j]])]), 
                      sd = sd(num_imbal_match_cov[[j]][!is.na(num_imbal_match_cov[[j]])]), 
                      sum = sum(num_imbal_match_cov[[j]][!is.na(num_imbal_match_cov[[j]])]), 
                      n = length(num_imbal_match_cov[[j]][!is.na(num_imbal_match_cov[[j]])])))
}

temp <- c(paste("Covariates observed post-match:", c("PSM, caliper=0.15", 
                                                     "CM, exact marginal distributional balance", 
                                                     "CM, maximum SMD=0.01", 
                                                     "CM, maximum SMD=0.05", 
                                                     "CM, maximum smd=0.10")),
          paste("Num imbal cov post-match: ", c("PSM, caliper=0.15", 
                                                "CM, exact marginal distributional balance", 
                                                "CM, maximum SMD=0.01", 
                                                "CM, maximum SMD=0.05", 
                                                "CM, maximum smd=0.10")),
          paste("Num imbal match cov post-match: ", c("PSM, caliper=0.15", 
                                                      "CM, exact marginal distributional balance", 
                                                      "CM, maximum SMD=0.01", 
                                                      "CM, maximum SMD=0.05", 
                                                      "CM, maximum smd=0.10")))
temp <- temp[c(seq(1, length(temp), 5), seq(2, length(temp), 5), seq(3, length(temp), 5),
               seq(4, length(temp), 5), seq(5, length(temp), 5))]
row.names(num_covs) <- c("Covariate candidates", "Matching covariates", 
                         "Num imbal cov pre", temp)
rm(temp)


# ==================================================================================================================
# Absolute Systematic Errors
# ==================================================================================================================

for(j in 1:6){
  if(j == 1){
    exp_abs_sys_err <- computeExpectedAbsoluteSystematicError(nulls[[j]])
  } else{
    exp_abs_sys_err <- rbind(exp_abs_sys_err, computeExpectedAbsoluteSystematicError(nulls[[j]]))
  }
}
row.names(exp_abs_sys_err) <- c("Pre-match",
                                "PSM, caliper=0.15", 
                                "CM, exact marginal distributional balance", 
                                "CM, maximum SMD=0.01", 
                                "CM, maximum SMD=0.05", 
                                "CM, maximum smd=0.10")


# ==================================================================================================================
# Summary tables
# ==================================================================================================================

# Create table
wb <- createWorkbook()
addWorksheet(wb, "sample_size", gridLines = FALSE)
addWorksheet(wb, "ncs_summary", gridLines = FALSE)
addWorksheet(wb, "smds", gridLines = FALSE)
addWorksheet(wb, "covariates", gridLines = FALSE)
addWorksheet(wb, "sys_error", gridLines = FALSE)

writeDataTable(wb, "sample_size", x = ss_df, startCol = 2, startRow = 2, colNames = TRUE, rowNames = TRUE)
writeDataTable(wb, "ncs_summary", x = ncs_summary, startCol = 2, startRow = 2, colNames = TRUE, rowNames = TRUE)
writeDataTable(wb, "smds", x = data.frame(match_smds), startCol = 2, startRow = 2, colNames = TRUE, rowNames = TRUE)
writeDataTable(wb, "smds", x = data.frame(all_smds), startCol = 2, startRow = 15, colNames = TRUE, rowNames = TRUE)
writeDataTable(wb, "covariates", x = data.frame(num_covs), startCol = 2, startRow = 2, colNames = TRUE, rowNames = TRUE)
writeDataTable(wb, "sys_error", x = data.frame(exp_abs_sys_err), startCol = 2, startRow = 2, colNames = TRUE, rowNames = TRUE)
# writeDataTable(wb, "cal_est", x = data.frame(cal_est), startCol = 2, startRow = 2, colNames = TRUE, rowNames = TRUE)

saveWorkbook(wb, "tables.xlsx", overwrite = TRUE)
rm(wb)


# ==================================================================================================================
# Create pooled table pre-match and post-PSM/CM
# ==================================================================================================================




########### MUST POOL Pre / PSM / CM cohorts ######################

unbal_matches$cohort

cohort_ids <- c(1, 2, 5, 6, 7, 8, 9, 10, 11, 12, 19, 20)







# ==================================================================================================================
# Objects
# ==================================================================================================================

# df.csv: covariate codes described in covariates contained in covariates$covariateRef[, ]
# psm.rds: matchit object, PSM caliper=0.15
# fine.rds: cardmatch object, CM SMD=0
# mom001.rds: cardmatch object, CM SMD=0.01
# mom005.rds: cardmatch object, CM SMD=0.05
# mom010.rds: cardmatch object, CM SMD=0.10
# balance_x.rds: SMD before and after matching for all covariates (match_var = 0) and matching covariates (match_var = 1)


# ==================================================================================================================
# Violin plot
# ==================================================================================================================

x1 <- bal_all
x2 <- bal_match
for(j in 1:5){
  
  if(length(x1) < j){
    next
  }
  
  if(j == 1){
    x1[[j]]$Analysis <- "PSM"
    x1[[j]]$parameter <- j + 1
  } else if(j == 2 | j == 3 | j == 4 | j == 5){
    x1[[j]]$Analysis <- "CM"
    x1[[j]]$parameter <- j + 1
  }
  
  if(length(x2) < j){
    next
  }
  
  if(j == 1){
    x2[[j]]$Analysis <- "PSM"
    x2[[j]]$parameter <- j + 1
  } else if(j == 2 | j == 3 | j == 4 | j == 5){
    x2[[j]]$Analysis <- "CM"
    x2[[j]]$parameter <- j + 1
  }
  
}

temp <- x1[[1]]
temp$parameter=1
temp$Analysis="Pre-match"
temp$afterMatchingStdDiff <- temp$beforeMatchingStdDiff
x1 <- rbind(temp, do.call(rbind, x1))
x2 <- rbind(temp, do.call(rbind, x2))
x1$afterMatchingStdDiff <- abs(x1$afterMatchingStdDiff)
x2$afterMatchingStdDiff <- abs(x2$afterMatchingStdDiff)

x1$Analysis <- factor(x1$Analysis, levels = c("Pre-match", "PSM", "CM"))
x2$Analysis <- factor(x2$Analysis, levels = c("Pre-match", "PSM", "CM"))


p1<- ggplot(x1, aes(group=parameter, x=parameter, y=afterMatchingStdDiff, fill=Analysis)) + 
  geom_violin(scale="width") +
  labs(title="0.125% Subsample Group", x="Parameter Settings", y="Standardized Mean Difference") +
  geom_hline(yintercept=c(0, 0.1), linetype='dashed') +
  scale_x_discrete(limit=c(1:6),
                   labels=c("Pre-match", "Caliper=0.15",
                            "Fine balance", "Max SMD=0.01", "Max SMD=0.05", "Max SMD=0.10")) +
  theme(axis.text.x = element_text(angle=90, vjust=0.5, hjust=1),
        plot.title = element_text(hjust=0.5))

p2<- ggplot(x2, aes(group=parameter, x=parameter, y=afterMatchingStdDiff, fill=Analysis)) + 
  geom_violin(scale="width") +
  labs(title="0.125% Subsample Group", x="Parameter Settings", y="Standardized Mean Difference") +
  geom_hline(yintercept=c(0, 0.1), linetype='dashed') +
  scale_x_discrete(limit=c(1:6),
                   labels=c("Pre-match", "Caliper=0.15",
                            "Fine balance", "Max SMD=0.01", "Max SMD=0.05", "Max SMD=0.10")) +
  theme(axis.text.x = element_text(angle=90, vjust=0.5, hjust=1),
        plot.title = element_text(hjust=0.5))



#### See boxPlots_facet.R
bal_all_4 <- bal_all
bal_match_4 <- bal_match





